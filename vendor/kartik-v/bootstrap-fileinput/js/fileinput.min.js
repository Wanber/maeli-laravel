/*!
 * bootstrap-fileinput v4.4.2
 * http://plugins.krajee.com/file-input
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2017, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(window.jQuery)}}}(function(c){c.fn.fileinputLocales={};c.fn.fileinputThemes={};String.prototype.setTokens=function(d){var g=this.toString(),e,f;for(e in d){if(d.hasOwnProperty(e)){f=new RegExp("{"+e+"}","g");g=g.replace(f,d[e])}}return g};var a,b;a={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",STYLE_SETTING:'style="width:{width};height:{height};"',OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||window.webkitURL,compare:function(d,f,e){return d!==undefined&&(e?d===f:d.match(f))},isIE:function(d){if(navigator.appName!=="Microsoft Internet Explorer"){return false}if(d===10){return new RegExp("msie\\s"+d,"i").test(navigator.userAgent)}var f=document.createElement("div"),e;f.innerHTML="<!--[if IE "+d+"]> <i></i> <![endif]-->";e=f.getElementsByTagName("i").length;document.body.appendChild(f);f.parentNode.removeChild(f);return e},initModal:function(d){var e=c("body");if(e.length){d.appendTo(e)}},isEmpty:function(e,d){return e===undefined||e===null||e.length===0||(d&&c.trim(e)==="")},isArray:function(d){return Array.isArray(d)||Object.prototype.toString.call(d)==="[object Array]"},ifSet:function(f,e,d){d=d||"";return(e&&typeof e==="object"&&f in e)?e[f]:d},cleanArray:function(d){if(!(d instanceof Array)){d=[]}return d.filter(function(f){return(f!==undefined&&f!==null)})},spliceArray:function(d,g){var h,f=0,e=[];if(!(d instanceof Array)){return[]}for(h=0;h<d.length;h++){if(h!==g){e[f]=d[h];f++}}return e},getNum:function(d,e){e=e||0;if(typeof d==="number"){return d}if(typeof d==="string"){d=parseFloat(d)}return isNaN(d)?e:d},hasFileAPISupport:function(){return !!(window.File&&window.FileReader)},hasDragDropSupport:function(){var d=document.createElement("div");return !a.isIE(9)&&(d.draggable!==undefined||(d.ondragstart!==undefined&&d.ondrop!==undefined))},hasFileUploadSupport:function(){return a.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return !!window.Blob&&Boolean(new Blob())}catch(d){return false}},hasArrayBufferViewSupport:function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(d){return false}},dataURI2Blob:function(g){var j=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,f=a.hasBlobSupport(),m,k,n,h,d,l,e=(f||j)&&window.atob&&window.ArrayBuffer&&window.Uint8Array;if(!e){return null}if(g.split(",")[0].indexOf("base64")>=0){m=atob(g.split(",")[1])}else{m=decodeURIComponent(g.split(",")[1])}k=new ArrayBuffer(m.length);n=new Uint8Array(k);for(h=0;h<m.length;h+=1){n[h]=m.charCodeAt(h)}d=g.split(",")[0].split(":")[1].split(";")[0];if(f){return new Blob([a.hasArrayBufferViewSupport()?n:k],{type:d})}l=new j();l.append(k);return l.getBlob(d)},addCss:function(e,d){e.removeClass(d).addClass(d)},getElement:function(d,f,e){return(a.isEmpty(d)||a.isEmpty(d[f]))?e:c(d[f])},uniqId:function(){return Math.round(new Date().getTime()+(Math.random()*100))},htmlEncode:function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(f,e){var d=f;if(!e){return d}c.each(e,function(g,h){if(typeof h==="function"){h=h()}d=d.split(g).join(h)});return d},cleanMemory:function(e){var d=e.is("img")?e.attr("src"):e.find("source").attr("src");a.objUrl.revokeObjectURL(d)},findFileName:function(d){var e=d.lastIndexOf("/");if(e===-1){e=d.lastIndexOf("\\")}return d.split(d.substring(e,e+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(e){var d=document,f=d.documentElement;if(f&&e&&!a.checkFullScreen()){if(f.requestFullscreen){f.requestFullscreen()}else{if(f.msRequestFullscreen){f.msRequestFullscreen()}else{if(f.mozRequestFullScreen){f.mozRequestFullScreen()}else{if(f.webkitRequestFullscreen){f.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}}}}else{if(d.exitFullscreen){d.exitFullscreen()}else{if(d.msExitFullscreen){d.msExitFullscreen()}else{if(d.mozCancelFullScreen){d.mozCancelFullScreen()}else{if(d.webkitExitFullscreen){d.webkitExitFullscreen()}}}}}},moveArray:function(d,g,f){if(f>=d.length){var e=f-d.length;while((e--)+1){d.push(undefined)}}d.splice(f,0,d.splice(g,1)[0]);return d},cleanZoomCache:function(d){var e=d.closest(".kv-zoom-cache-theme");if(!e.length){e=d.closest(".kv-zoom-cache")}e.remove()},setOrientation:function(g,k){var i=new DataView(g),d=0,j=1,h,f,e;if(i.getUint16(d)!==65496||g.length<2){return}d+=2;h=i.byteLength;while(d<h-2){f=i.getUint16(d);d+=2;switch(f){case 65505:e=i.getUint16(d);h=e-d;d+=2;break;case 274:j=i.getUint16(d+6,false);h=0;break}}if(k){k(j)}},validateOrientation:function(f,g){if(!window.FileReader||!window.DataView){return}var d=new FileReader(),e;d.onloadend=function(){e=d.result;a.setOrientation(e,g)};d.readAsArrayBuffer(f)},adjustOrientedImage:function(f,h){var e,g,d;if(!f.hasClass("is-portrait-gt4")){return}if(h){f.css({width:f.parent().height()});return}else{f.css({height:"auto",width:f.height()})}e=f.parent().offset().top;g=f.offset().top;d=e-g;f.css("margin-top",d)}};b=function(f,e){var d=this;d.$element=c(f);if(!d._validate()){return}d.isPreviewable=a.hasFileAPISupport();d.isIE9=a.isIE(9);d.isIE10=a.isIE(10);if(d.isPreviewable||d.isIE9){d._init(e);d._listen()}else{d.$element.removeClass("file-loading")}};b.prototype={constructor:b,_cleanup:function(){var d=this;d.reader=null;d.formdata={};d.uploadCount=0;d.uploadStatus={};d.uploadLog=[];d.uploadAsyncCount=0;d.loadedImages=[];d.totalImagesCount=0;d.ajaxRequests=[];d.clearStack();d.fileInputCleared=false;d.fileBatchCompleted=true;if(!d.isPreviewable){d.showPreview=false}d.isError=false;d.ajaxAborted=false;d.cancelling=false},_init:function(e){var d=this,h=d.$element,i,g,f;d.options=e;c.each(e,function(j,k){switch(j){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":d[j]=a.getNum(k);break;default:d[j]=k;break}});if(d.rtl){f=d.previewZoomButtonIcons.prev;d.previewZoomButtonIcons.prev=d.previewZoomButtonIcons.next;d.previewZoomButtonIcons.next=f}d._cleanup();d.$form=h.closest("form");d._initTemplateDefaults();d.uploadFileAttr=!a.isEmpty(h.attr("name"))?h.attr("name"):"file_data";g=d._getLayoutTemplate("progress");d.progressTemplate=g.replace("{class}",d.progressClass);d.progressCompleteTemplate=g.replace("{class}",d.progressCompleteClass);d.progressErrorTemplate=g.replace("{class}",d.progressErrorClass);d.dropZoneEnabled=a.hasDragDropSupport()&&d.dropZoneEnabled;d.isDisabled=h.attr("disabled")||h.attr("readonly");if(d.isDisabled){h.attr("disabled",true)}d.isUploadable=a.hasFileUploadSupport()&&!a.isEmpty(d.uploadUrl);d.isClickable=d.browseOnZoneClick&&d.showPreview&&(d.isUploadable&&d.dropZoneEnabled||!a.isEmpty(d.defaultPreviewContent));d.slug=typeof e.slugCallback==="function"?e.slugCallback:d._slugDefault;d.mainTemplate=d.showCaption?d._getLayoutTemplate("main1"):d._getLayoutTemplate("main2");d.captionTemplate=d._getLayoutTemplate("caption");d.previewGenericTemplate=d._getPreviewTemplate("generic");if(d.resizeImage&&(d.maxImageWidth||d.maxImageHeight)){d.imageCanvas=document.createElement("canvas");d.imageCanvasContext=d.imageCanvas.getContext("2d")}if(a.isEmpty(h.attr("id"))){h.attr("id",a.uniqId())}d.namespace=".fileinput_"+h.attr("id").replace(/-/g,"_");if(d.$container===undefined){d.$container=d._createContainer()}else{d._refreshContainer()}i=d.$container;d.$dropZone=i.find(".file-drop-zone");d.$progress=i.find(".kv-upload-progress");d.$btnUpload=i.find(".fileinput-upload");d.$captionContainer=a.getElement(e,"elCaptionContainer",i.find(".file-caption"));d.$caption=a.getElement(e,"elCaptionText",i.find(".file-caption-name"));d.$previewContainer=a.getElement(e,"elPreviewContainer",i.find(".file-preview"));d.$preview=a.getElement(e,"elPreviewImage",i.find(".file-preview-thumbnails"));d.$previewStatus=a.getElement(e,"elPreviewStatus",i.find(".file-preview-status"));d.$errorContainer=a.getElement(e,"elErrorContainer",d.$previewContainer.find(".kv-fileinput-error"));if(!a.isEmpty(d.msgErrorClass)){a.addCss(d.$errorContainer,d.msgErrorClass)}d.$errorContainer.hide();d.previewInitId="preview-"+a.uniqId();d._initPreviewCache();d._initPreview(true);d._initPreviewActions();d._setFileDropZoneTitle();h.removeClass("file-loading");if(h.attr("disabled")){d.disable()}d._initZoom()},_initTemplateDefaults:function(){var k=this,e,d,u,q,s,I,x,f,y,m,M,r,n,N,H,t,o,w,L,h,E,K,J,p,l,C,G,B,F,i,j,v,z,A,D,g;e='{preview}\n<div class="kv-upload-progress hide"></div>\n<div class="input-group {class}">\n   {caption}\n   <div class="input-group-btn">\n       {remove}\n       {cancel}\n       {upload}\n       {browse}\n   </div>\n</div>';d='{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n';u='<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>';s='<div class="close fileinput-remove">&times;</div>\n';q='<i class="glyphicon glyphicon-file kv-caption-icon"></i>';I='<div tabindex="500" class="form-control file-caption {class}">\n   <div class="file-caption-name"></div>\n</div>\n';x='<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>';f='<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>';y='<div tabindex="500" class="{css}" {status}>{icon} {label}</div>';m='<div id="'+a.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+a.MODAL_ID+'Label"></div>';M='<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <div class="kv-zoom-actions pull-right">{toggleheader}{fullscreen}{borderless}{close}</div>\n      <h3 class="modal-title">{heading} <small><span class="kv-zoom-title"></span></small></h3>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n';r='<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>';n=" <samp>({sizeText})</samp>";N='<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">{caption}<br>{size}</div>\n    {progress} {indicator} {actions}\n</div>';H='{drag}\n<div class="file-actions">\n    <div class="file-footer-buttons">\n        {upload} {delete} {zoom} {other}    </div>\n    <div class="clearfix"></div>\n</div>';t='<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n';o='<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>';w='<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>';L='<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>';h='<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>';E='<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"';K=E+'><div class="kv-file-content">\n';J=E+' title="{caption}"><div class="kv-file-content">\n';p="</div>{footer}\n</div>\n";l="{content}\n";C='<div class="kv-preview-data file-preview-html" title="{caption}" '+a.STYLE_SETTING+">{data}</div>\n";G='<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" '+a.STYLE_SETTING+">\n";B='<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly '+a.STYLE_SETTING+">{data}</textarea>\n";F='<video class="kv-preview-data file-preview-video" width="{width}" height="{height}" controls>\n<source src="{data}" type="{type}">\n'+a.DEFAULT_PREVIEW+"\n</video>\n";i='<div class="file-preview-audio"><audio class="kv-preview-data" controls>\n<source src="{data}" type="{type}">\n'+a.DEFAULT_PREVIEW+"\n</audio></div>\n";j='<object class="kv-preview-data file-object" type="application/x-shockwave-flash" width="{width}" height="{height}" data="{data}">\n'+a.OBJECT_PARAMS+" "+a.DEFAULT_PREVIEW+"\n</object>\n";v='<object class="kv-preview-data file-object {typeCss}" data="{data}" type="{type}" width="{width}" height="{height}">\n<param name="movie" value="{caption}" />\n'+a.OBJECT_PARAMS+" "+a.DEFAULT_PREVIEW+"\n</object>\n";z='<embed class="kv-preview-data" src="{data}" width="{width}" height="{height}" type="application/pdf">\n';A='<div class="kv-preview-data file-preview-other-frame">\n'+a.DEFAULT_PREVIEW+"\n</div>\n";D='<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>';g={width:"100%",height:"100%","min-height":"480px"};k.defaults={layoutTemplates:{main1:e,main2:d,preview:u,close:s,fileIcon:q,caption:I,modalMain:m,modal:M,progress:r,size:n,footer:N,indicator:h,actions:H,actionDelete:t,actionUpload:o,actionZoom:w,actionDrag:L,btnDefault:x,btnLink:f,btnBrowse:y,zoomCache:D},previewMarkupTags:{tagBefore1:K,tagBefore2:J,tagAfter:p},previewContentTemplates:{generic:l,html:C,image:G,text:B,video:F,audio:i,flash:j,object:v,pdf:z,other:A},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"160px"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"100%","max-width":"100%"},object:{height:"100%"},pdf:{width:"160px",height:"160px"},other:{width:"160px",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:g,text:g,video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:g,other:{width:"auto",height:"100%","min-height":"480px"}},fileTypeSettings:{image:function(P,O){return a.compare(P,"image.*")||a.compare(O,/\.(gif|png|jpe?g)$/i)},html:function(P,O){return a.compare(P,"text/html")||a.compare(O,/\.(htm|html)$/i)},text:function(P,O){return a.compare(P,"text.*")||a.compare(O,/\.(xml|javascript)$/i)||a.compare(O,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(P,O){return a.compare(P,"video.*")&&(a.compare(P,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||a.compare(O,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(P,O){return a.compare(P,"audio.*")&&(a.compare(O,/(ogg|mp3|mp?g|wav)$/i)||a.compare(O,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(P,O){return a.compare(P,"application/x-shockwave-flash",true)||a.compare(O,/\.(swf)$/i)},pdf:function(P,O){return a.compare(P,"application/pdf",true)||a.compare(O,/\.(pdf)$/i)},object:function(){return true},other:function(){return true}},fileActionSettings:{showRemove:true,showUpload:true,showZoom:true,showDrag:true,removeIcon:'<i class="glyphicon glyphicon-trash text-danger"></i>',removeClass:"btn btn-xs btn-default",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload text-info"></i>',uploadClass:"btn btn-xs btn-default",uploadTitle:"Upload file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-xs btn-default",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-menu-hamburger"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-hand-down text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hand-up text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}};c.each(k.defaults,function(O,P){if(O==="allowedPreviewTypes"){if(k.allowedPreviewTypes===undefined){k.allowedPreviewTypes=P}return}k[O]=c.extend(true,{},P,k[O])});k._initPreviewTemplates()},_initPreviewTemplates:function(){var e=this,d=e.defaults,f=e.previewMarkupTags,g,h=f.tagAfter;c.each(d.previewContentTemplates,function(i,j){if(a.isEmpty(e.previewTemplates[i])){g=f.tagBefore2;if(i==="generic"||i==="image"||i==="html"||i==="text"){g=f.tagBefore1}e.previewTemplates[i]=g+j+h}})},_initPreviewCache:function(){var d=this;d.previewCache={data:{},init:function(){var e=d.initialPreview;if(e.length>0&&!a.isArray(e)){e=e.split(d.initialPreviewDelimiter)}d.previewCache.data={content:e,config:d.initialPreviewConfig,tags:d.initialPreviewThumbTags}},fetch:function(){return d.previewCache.data.content.filter(function(e){return e!==null})},count:function(e){return !!d.previewCache.data&&!!d.previewCache.data.content?(e?d.previewCache.data.content.length:d.previewCache.fetch().length):0},get:function(m,t){var g="init_"+m,l=d.previewCache.data,h=l.config[m],o=l.content[m],p=d.previewInitId+"-"+g,k,e,q,s,f,r,u,n=a.ifSet("previewAsData",h,d.initialPreviewAsData),j=function(z,C,y,x,i,A,v,w,B){w=" file-preview-initial "+a.SORT_CSS+(w?" "+w:"");return d._generatePreviewTemplate(z,C,y,x,i,false,null,w,A,v,B)};if(!o){return""}t=t===undefined?true:t;q=a.ifSet("type",h,d.initialPreviewFileType||"generic");f=a.ifSet("filename",h,a.ifSet("caption",h));r=a.ifSet("filetype",h,q);s=d.previewCache.footer(m,t,(h&&h.size||null));u=a.ifSet("frameClass",h);if(n){k=j(q,o,f,r,p,s,g,u)}else{k=j("generic",o,f,r,p,s,g,u,q).setTokens({content:l.content[m]})}if(l.tags.length&&l.tags[m]){k=a.replaceTags(k,l.tags[m])}if(!a.isEmpty(h)&&!a.isEmpty(h.frameAttr)){e=c(document.createElement("div")).html(k);e.find(".file-preview-initial").attr(h.frameAttr);k=e.html();e.remove()}return k},add:function(i,h,g,e){var j=d.previewCache.data,f;if(!a.isArray(i)){i=i.split(d.initialPreviewDelimiter)}if(e){f=j.content.push(i)-1;j.config[f]=h;j.tags[f]=g}else{f=i.length-1;j.content=i;j.config=h;j.tags=g}d.previewCache.data=j;return f},set:function(k,h,g,e){var l=d.previewCache.data,j,f;if(!k||!k.length){return}if(!a.isArray(k)){k=k.split(d.initialPreviewDelimiter)}f=k.filter(function(i){return i!==null});if(!f.length){return}if(l.content===undefined){l.content=[]}if(l.config===undefined){l.config=[]}if(l.tags===undefined){l.tags=[]}if(e){for(j=0;j<k.length;j++){if(k[j]){l.content.push(k[j])}}for(j=0;j<h.length;j++){if(h[j]){l.config.push(h[j])}}for(j=0;j<g.length;j++){if(g[j]){l.tags.push(g[j])}}}else{l.content=k;l.config=h;l.tags=g}d.previewCache.data=l},unset:function(f){var e=d.previewCache.count();if(!e){return}if(e===1){d.previewCache.data.content=[];d.previewCache.data.config=[];d.previewCache.data.tags=[];d.initialPreview=[];d.initialPreviewConfig=[];d.initialPreviewThumbTags=[];return}d.previewCache.data.content[f]=null;d.previewCache.data.config[f]=null;d.previewCache.data.tags[f]=null},out:function(){var h="",f,e=d.previewCache.count(true),g;if(e===0){return{content:"",caption:""}}for(g=0;g<e;g++){h+=d.previewCache.get(g)}f=d._getMsgSelected(d.previewCache.count());return{content:h,caption:f}},footer:function(n,s,u){var m=d.previewCache.data;if(!m||!m.config||m.config.length===0||a.isEmpty(m.config[n])){return""}s=s===undefined?true:s;var h=m.config[n],t=a.ifSet("caption",h),k,f=a.ifSet("width",h,"auto"),e=a.ifSet("url",h,false),r=a.ifSet("key",h,null),o=d.fileActionSettings,q=d.initialPreviewShowDelete||false,l=a.ifSet("showDelete",h,a.ifSet("showDelete",o,q)),p=a.ifSet("showZoom",h,a.ifSet("showZoom",o,true)),g=a.ifSet("showDrag",h,a.ifSet("showDrag",o,true)),j=(e===false)&&s;k=d._renderFileActions(false,l,p,g,j,e,r,true);return d._getLayoutTemplate("footer").setTokens({progress:d._renderThumbProgress(),actions:k,caption:t,size:d._getSize(u),width:f,indicator:""})}};d.previewCache.init()},_handler:function(e,h,i){var d=this,f=d.namespace,g=h.split(" ").join(f+" ")+f;if(!e||!e.length){return}e.off(g).on(g,i)},_log:function(e){var d=this,f=d.$element.attr("id");if(f){e='"'+f+'": '+e}if(typeof window.console.log!=="undefined"){window.console.log(e)}else{window.alert(e)}},_validate:function(){var e=this,d=e.$element.attr("type")==="file";if(!d){e._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.')}return d},_errorsExist:function(){var d=this,e;if(d.$errorContainer.find("li").length){return true}e=c(document.createElement("div")).html(d.$errorContainer.html());e.find("span.kv-error-close").remove();e.find("ul").remove();return c.trim(e.text()).length?true:false},_errorHandler:function(e,g){var f=this,h=e.target.error,d=function(i){f._showError(i.replace("{name}",g))};if(h.code===h.NOT_FOUND_ERR){d(f.msgFileNotFound)}else{if(h.code===h.SECURITY_ERR){d(f.msgFileSecured)}else{if(h.code===h.NOT_READABLE_ERR){d(f.msgFileNotReadable)}else{if(h.code===h.ABORT_ERR){d(f.msgFilePreviewAborted)}else{d(f.msgFilePreviewError)}}}}},_addError:function(f){var e=this,d=e.$errorContainer;if(f&&d.length){d.html(e.errorCloseButton+f);e._handler(d.find(".kv-error-close"),"click",function(){d.fadeOut("slow")})}},_resetErrors:function(f){var e=this,d=e.$errorContainer;e.isError=false;e.$container.removeClass("has-error");d.html("");if(f){d.fadeOut("slow")}else{d.hide()}},_showFolderError:function(f){var e=this,d=e.$errorContainer,g;if(!f){return}g=e.msgFoldersNotAllowed.replace("{n}",f);e._addError(g);a.addCss(e.$container,"has-error");d.fadeIn(800);e._raise("filefoldererror",[f,g])},_showUploadError:function(k,j,h){var f=this,d=f.$errorContainer,g=h||"fileuploaderror",i=j&&j.id?'<li data-file-id="'+j.id+'">'+k+"</li>":"<li>"+k+"</li>";if(d.find("ul").length===0){f._addError("<ul>"+i+"</ul>")}else{d.find("ul").append(i)}d.fadeIn(800);f._raise(g,[j,k]);f.$container.removeClass("file-input-new");a.addCss(f.$container,"has-error");return true},_showError:function(i,h,g){var e=this,d=e.$errorContainer,f=g||"fileerror";h=h||{};h.reader=e.reader;e._addError(i);d.fadeIn(800);e._raise(f,[h,i]);if(!e.isUploadable){e._clearFileInput()}e.$container.removeClass("file-input-new");a.addCss(e.$container,"has-error");e.$btnUpload.attr("disabled",true);return true},_noFilesError:function(h){var e=this,f=e.minFileCount>1?e.filePlural:e.fileSingle,g=e.msgFilesTooLess.replace("{n}",e.minFileCount).replace("{files}",f),d=e.$errorContainer;e._addError(g);e.isError=true;e._updateFileDetails(0);d.fadeIn(800);e._raise("fileerror",[h,g]);e._clearFileInput();a.addCss(e.$container,"has-error")},_parseError:function(f,h,i,k){var e=this,g=c.trim(i+""),d=g.slice(-1)==="."?"":".",j=h.responseJSON!==undefined&&h.responseJSON.error!==undefined?h.responseJSON.error:h.responseText;if(e.cancelling&&e.msgUploadAborted){g=e.msgUploadAborted}if(e.showAjaxErrorDetails&&j){j=c.trim(j.replace(/\n\s*\n/g,"\n"));j=j.length>0?"<pre>"+j+"</pre>":"";g+=d+j}else{g+=d}if(g===d){g=e.msgAjaxError.replace("{operation}",f)}e.cancelling=false;return k?"<b>"+k+": </b>"+g:g},_parseFileType:function(h){var e=this,k,j,d,g,f=e.allowedPreviewTypes||[];for(g=0;g<f.length;g++){d=f[g];k=e.fileTypeSettings[d];j=k(h.type,h.name)?d:"";if(!a.isEmpty(j)){return j}}return"other"},_getPreviewIcon:function(g){var d=this,f,e=null;if(g&&g.indexOf(".")>-1){f=g.split(".").pop();if(d.previewFileIconSettings){e=d.previewFileIconSettings[f]||d.previewFileIconSettings[f.toLowerCase()]||null}if(d.previewFileExtSettings){c.each(d.previewFileExtSettings,function(h,i){if(d.previewFileIconSettings[h]&&i(f)){e=d.previewFileIconSettings[h];return}})}}return e},_parseFilePreviewIcon:function(f,h){var d=this,g=d._getPreviewIcon(h)||d.previewFileIcon,e=f;if(e.indexOf("{previewFileIcon}")>-1){e=e.setTokens({previewFileIconClass:d.previewFileIconClass,previewFileIcon:g})}return e},_raise:function(f,h){var d=this,g=c.Event(f);if(h!==undefined){d.$element.trigger(g,h)}else{d.$element.trigger(g)}if(g.isDefaultPrevented()||g.result===false){return false}switch(f){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:if(!d.ajaxAborted){d.ajaxAborted=g.result}break}return true},_listenFullScreen:function(d){var e=this,f=e.$modal,g,h;if(!f||!f.length){return}g=f&&f.find(".btn-fullscreen");h=f&&f.find(".btn-borderless");if(!g.length||!h.length){return}g.removeClass("active").attr("aria-pressed","false");h.removeClass("active").attr("aria-pressed","false");if(d){g.addClass("active").attr("aria-pressed","true")}else{h.addClass("active").attr("aria-pressed","true")}if(f.hasClass("file-zoom-fullscreen")){e._maximizeZoomDialog()}else{if(d){e._maximizeZoomDialog()}else{h.removeClass("active").attr("aria-pressed","false")}}},_listen:function(){var e=this,f=e.$element,d=e.$form,h=e.$container,g;e._handler(f,"change",c.proxy(e._change,e));if(e.showBrowse){e._handler(e.$btnFile,"click",c.proxy(e._browse,e))}e._handler(h.find(".fileinput-remove:not([disabled])"),"click",c.proxy(e.clear,e));e._handler(h.find(".fileinput-cancel"),"click",c.proxy(e.cancel,e));e._initDragDrop();e._handler(d,"reset",c.proxy(e.reset,e));if(!e.isUploadable){e._handler(d,"submit",c.proxy(e._submitForm,e))}e._handler(e.$container.find(".fileinput-upload"),"click",c.proxy(e._uploadClick,e));e._handler(c(window),"resize",function(){e._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)});g="webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange";e._handler(c(document),g,function(){e._listenFullScreen(a.checkFullScreen())});e._initClickable()},_initClickable:function(){var d=this,e;if(!d.isClickable){return}e=d.isUploadable?d.$dropZone:d.$preview.find(".file-default-preview");a.addCss(e,"clickable");e.attr("tabindex",-1);d._handler(e,"click",function(g){var f=c(g.target);if(!f.parents(".file-preview-thumbnails").length||f.parents(".file-default-preview").length){d.$element.trigger("click");e.blur()}})},_initDragDrop:function(){var d=this,e=d.$dropZone;if(d.isUploadable&&d.dropZoneEnabled&&d.showPreview){d._handler(e,"dragenter dragover",c.proxy(d._zoneDragEnter,d));d._handler(e,"dragleave",c.proxy(d._zoneDragLeave,d));d._handler(e,"drop",c.proxy(d._zoneDrop,d));d._handler(c(document),"dragenter dragover drop",d._zoneDragDropInit)}},_zoneDragDropInit:function(d){d.stopPropagation();d.preventDefault()},_zoneDragEnter:function(g){var d=this,f=c.inArray("Files",g.originalEvent.dataTransfer.types)>-1;d._zoneDragDropInit(g);if(d.isDisabled||!f){g.originalEvent.dataTransfer.effectAllowed="none";g.originalEvent.dataTransfer.dropEffect="none";return}a.addCss(d.$dropZone,"file-highlighted")},_zoneDragLeave:function(f){var d=this;d._zoneDragDropInit(f);if(d.isDisabled){return}d.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(f){var d=this;f.preventDefault();if(d.isDisabled||a.isEmpty(f.originalEvent.dataTransfer.files)){return}d._change(f,"dragdrop");d.$dropZone.removeClass("file-highlighted")},_uploadClick:function(i){var f=this,h=f.$container.find(".fileinput-upload"),d,g=!h.hasClass("disabled")&&a.isEmpty(h.attr("disabled"));if(i&&i.isDefaultPrevented()){return}if(!f.isUploadable){if(g&&h.attr("type")!=="submit"){d=h.closest("form");if(d.length){d.trigger("submit")}i.preventDefault()}return}i.preventDefault();if(g){f.upload()}},_submitForm:function(){var d=this;return d._isFileSelectionValid()&&!d._abort({})},_clearPreview:function(){var d=this,e=d.$preview,f=d.showUploadedThumbs?d.getFrames(":not(.file-preview-success)"):d.getFrames();f.each(function(){var g=c(this);g.remove();a.cleanZoomCache(e.find("#zoom-"+g.attr("id")))});if(!d.getFrames().length||!d.showPreview){d._resetUpload()}d._validateDefaultPreview()},_initSortable:function(){var e=this,f=e.$preview,g,d="."+a.SORT_CSS;if(!window.KvSortable||f.find(d).length===0){return}g={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:false,draggable:d,onSort:function(m){var n=m.oldIndex,k=m.newIndex,j,l;e.initialPreview=a.moveArray(e.initialPreview,n,k);e.initialPreviewConfig=a.moveArray(e.initialPreviewConfig,n,k);e.previewCache.init();for(var h=0;h<e.initialPreviewConfig.length;h++){if(e.initialPreviewConfig[h]!==null){j=e.initialPreviewConfig[h].key;l=c(".kv-file-remove[data-key='"+j+"']").closest(a.FRAMES);l.attr("data-fileindex","init_"+h).attr("data-fileindex","init_"+h)}}e._raise("filesorted",{previewId:c(m.item).attr("id"),oldIndex:n,newIndex:k,stack:e.initialPreviewConfig})}};if(f.data("kvsortable")){f.kvsortable("destroy")}c.extend(true,g,e.fileActionSettings.dragSettings);f.kvsortable(g)},_initPreview:function(g){var d=this,f=d.initialCaption||"",e;if(!d.previewCache.count()){d._clearPreview();if(g){d._setCaption(f)}else{d._initCaption()}return}e=d.previewCache.out();f=g&&d.initialCaption?d.initialCaption:e.caption;d.$preview.html(e.content);d._setInitThumbAttr();d._setCaption(f);d._initSortable();if(!a.isEmpty(e.content)){d.$container.removeClass("file-input-new")}},_getZoomButton:function(g){var d=this,e=d.previewZoomButtonIcons[g],f=d.previewZoomButtonClasses[g],i=' title="'+(d.previewZoomButtonTitles[g]||"")+'" ',h=i+(g==="close"?' data-dismiss="modal" aria-hidden="true"':"");if(g==="fullscreen"||g==="borderless"||g==="toggleheader"){h+=' data-toggle="button" aria-pressed="false" autocomplete="off"'}return'<button type="button" class="'+f+" btn-"+g+'"'+h+">"+e+"</button>"},_getModalContent:function(){var d=this;return d._getLayoutTemplate("modal").setTokens({rtl:d.rtl?" kv-rtl":"",zoomFrameClass:d.frameClass,heading:d.msgZoomModalHeading,prev:d._getZoomButton("prev"),next:d._getZoomButton("next"),toggleheader:d._getZoomButton("toggleheader"),fullscreen:d._getZoomButton("fullscreen"),borderless:d._getZoomButton("borderless"),close:d._getZoomButton("close")})},_listenModalEvent:function(f){var d=this,e=d.$modal,g=function(h){return{sourceEvent:h,previewId:e.data("previewId"),modal:e}};e.on(f+".bs.modal",function(i){var h=e.find(".btn-fullscreen"),j=e.find(".btn-borderless");d._raise("filezoom"+f,g(i));if(f==="shown"){j.removeClass("active").attr("aria-pressed","false");h.removeClass("active").attr("aria-pressed","false");if(e.hasClass("file-zoom-fullscreen")){d._maximizeZoomDialog();if(a.checkFullScreen()){h.addClass("active").attr("aria-pressed","true")}else{j.addClass("active").attr("aria-pressed","true")}}}})},_initZoom:function(){var f=this,g,e=f._getLayoutTemplate("modalMain"),d="#"+a.MODAL_ID;if(!f.showPreview){return}f.$modal=c(d);if(!f.$modal||!f.$modal.length){g=c(document.createElement("div")).html(e).insertAfter(f.$container);f.$modal=c(d).insertBefore(g);g.remove()}a.initModal(f.$modal);f.$modal.html(f._getModalContent());c.each(a.MODAL_EVENTS,function(h,i){f._listenModalEvent(i)})},_initZoomButtons:function(){var j=this,g=j.$modal.data("previewId")||"",k,i,f=j.getFrames().toArray(),d=f.length,h=j.$modal.find(".btn-prev"),e=j.$modal.find(".btn-next");if(f.length<2){h.hide();e.hide();return}else{h.show();e.show()}if(!d){return}k=c(f[0]);i=c(f[d-1]);h.removeAttr("disabled");e.removeAttr("disabled");if(k.length&&k.attr("id")===g){h.attr("disabled",true)}if(i.length&&i.attr("id")===g){e.attr("disabled",true)}},_maximizeZoomDialog:function(){var f=this,g=f.$modal,e=g.find(".modal-header:visible"),d=g.find(".modal-footer:visible"),j=g.find(".modal-body"),i=c(window).height(),k=0;g.addClass("file-zoom-fullscreen");if(e&&e.length){i-=e.outerHeight(true)}if(d&&d.length){i-=d.outerHeight(true)}if(j&&j.length){k=j.outerHeight(true)-j.height();i-=k}g.find(".kv-zoom-body").height(i)},_resizeZoomDialog:function(f){var d=this,e=d.$modal,g=e.find(".btn-fullscreen"),h=e.find(".btn-borderless");if(e.hasClass("file-zoom-fullscreen")){a.toggleFullScreen(false);if(!f){if(!g.hasClass("active")){e.removeClass("file-zoom-fullscreen");d.$modal.find(".kv-zoom-body").css("height",d.zoomModalHeight)}else{g.removeClass("active").attr("aria-pressed","false")}}else{if(!g.hasClass("active")){e.removeClass("file-zoom-fullscreen");d._resizeZoomDialog(true);if(h.hasClass("active")){h.removeClass("active").attr("aria-pressed","false")}}}}else{if(!f){d._maximizeZoomDialog();return}a.toggleFullScreen(true)}e.focus()},_setZoomContent:function(e,h){var s=this,g,d,o,y,u,k,x,q=e.attr("id"),n=s.$modal,v=n.find(".btn-prev"),w=n.find(".btn-next"),i,l=n.find(".btn-fullscreen"),t=n.find(".btn-borderless"),m,r,p=n.find(".btn-toggleheader"),f=s.$preview.find("#zoom-"+q);d=f.attr("data-template")||"generic";g=f.find(".kv-file-content");o=g.length?g.html():"";m=e.data("caption")||"";r=e.data("size")||"";y=m+" "+r;n.find(".kv-zoom-title").html(y);u=n.find(".kv-zoom-body");n.removeClass("kv-single-content");if(h){i=u.addClass("file-thumb-loading").clone().insertAfter(u);u.html(o).hide();i.fadeOut("fast",function(){u.fadeIn("fast",function(){u.removeClass("file-thumb-loading")});i.remove()})}else{u.html(o)}x=s.previewZoomSettings[d];if(x){k=u.find(".kv-preview-data");a.addCss(k,"file-zoom-detail");c.each(x,function(z,A){k.css(z,A);if((k.attr("width")&&z==="width")||(k.attr("height")&&z==="height")){k.removeAttr(z)}})}n.data("previewId",q);var j=u.find("img");if(j.length){a.adjustOrientedImage(j,true)}s._handler(v,"click",function(){s._zoomSlideShow("prev",q)});s._handler(w,"click",function(){s._zoomSlideShow("next",q)});s._handler(l,"click",function(){s._resizeZoomDialog(true)});s._handler(t,"click",function(){s._resizeZoomDialog(false)});s._handler(p,"click",function(){var z=n.find(".modal-header"),D=n.find(".modal-body .floating-buttons"),B,C=z.find(".kv-zoom-actions"),A=function(E){var G=s.$modal.find(".kv-zoom-body"),F=s.zoomModalHeight;if(n.hasClass("file-zoom-fullscreen")){F=G.outerHeight(true);if(!E){F=F-z.outerHeight(true)}}G.css("height",E?F+E:F)};if(z.is(":visible")){B=z.outerHeight(true);z.slideUp("slow",function(){C.find(".btn").appendTo(D);A(B)})}else{D.find(".btn").appendTo(C);z.slideDown("slow",function(){A()})}n.focus()});s._handler(n,"keydown",function(A){var z=A.which||A.keyCode;if(z===37&&!v.attr("disabled")){s._zoomSlideShow("prev",q)}if(z===39&&!w.attr("disabled")){s._zoomSlideShow("next",q)}})},_zoomPreview:function(g){var d=this,f,e=d.$modal;if(!g.length){throw"Cannot zoom to detailed preview!"}a.initModal(e);e.html(d._getModalContent());f=g.closest(a.FRAMES);d._setZoomContent(f);e.modal("show");d._initZoomButtons()},_zoomSlideShow:function(d,h){var l=this,k=l.$modal.find(".kv-zoom-actions .btn-"+d),m,f,j=l.getFrames().toArray(),g=j.length,e;if(k.attr("disabled")){return}for(f=0;f<g;f++){if(c(j[f]).attr("id")===h){e=d==="prev"?f-1:f+1;break}}if(e<0||e>=g||!j[e]){return}m=c(j[e]);if(m.length){l._setZoomContent(m,true)}l._initZoomButtons();l._raise("filezoom"+d,{previewId:h,modal:l.$modal})},_initZoomButton:function(){var d=this;d.$preview.find(".kv-file-zoom").each(function(){var e=c(this);d._handler(e,"click",function(){d._zoomPreview(e)})})},_clearObjects:function(d){d.find("video audio").each(function(){this.pause();c(this).remove()});d.find("img object div").each(function(){c(this).remove()})},_clearFileInput:function(){var f=this,g=f.$element,h,d,e;f.fileInputCleared=true;if(a.isEmpty(g.val())){return}if(f.isIE9||f.isIE10){h=g.closest("form");d=c(document.createElement("form"));e=c(document.createElement("div"));g.before(e);if(h.length){h.after(d)}else{e.after(d)}d.append(g).trigger("reset");e.before(g).remove();d.remove()}else{g.val("")}},_resetUpload:function(){var d=this;d.uploadCache={content:[],config:[],tags:[],append:true};d.uploadCount=0;d.uploadStatus={};d.uploadLog=[];d.uploadAsyncCount=0;d.loadedImages=[];d.totalImagesCount=0;d.$btnUpload.removeAttr("disabled");d._setProgress(0);a.addCss(d.$progress,"hide");d._resetErrors(false);d.ajaxAborted=false;d.ajaxRequests=[];d._resetCanvas();d.cacheInitialPreview={};if(d.overwriteInitial){d.initialPreview=[];d.initialPreviewConfig=[];d.initialPreviewThumbTags=[];d.previewCache.data={content:[],config:[],tags:[]}}},_resetCanvas:function(){var d=this;if(d.canvas&&d.imageCanvasContext){d.imageCanvasContext.clearRect(0,0,d.canvas.width,d.canvas.height)}},_hasInitialPreview:function(){var d=this;return !d.overwriteInitial&&d.previewCache.count()},_resetPreview:function(){var d=this,e,f;if(d.previewCache.count()){e=d.previewCache.out();d.$preview.html(e.content);d._setInitThumbAttr();f=d.initialCaption?d.initialCaption:e.caption;d._setCaption(f)}else{d._clearPreview();d._initCaption()}if(d.showPreview){d._initZoom();d._initSortable()}},_clearDefaultPreview:function(){var d=this;d.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){var d=this;if(!d.showPreview||a.isEmpty(d.defaultPreviewContent)){return}d.$preview.html('<div class="file-default-preview">'+d.defaultPreviewContent+"</div>");d.$container.removeClass("file-input-new");d._initClickable()},_resetPreviewThumbs:function(f){var d=this,e;if(f){d._clearPreview();d.clearStack();return}if(d._hasInitialPreview()){e=d.previewCache.out();d.$preview.html(e.content);d._setInitThumbAttr();d._setCaption(e.caption);d._initPreviewActions()}else{d._clearPreview()}},_getLayoutTemplate:function(e){var d=this,f=d.layoutTemplates[e];if(a.isEmpty(d.customLayoutTags)){return f}return a.replaceTags(f,d.customLayoutTags)},_getPreviewTemplate:function(e){var d=this,f=d.previewTemplates[e];if(a.isEmpty(d.customPreviewTags)){return f}return a.replaceTags(f,d.customPreviewTags)},_getOutData:function(f,e,g){var d=this;f=f||{};e=e||{};g=g||d.filestack.slice(0)||{};return{form:d.formdata,files:g,filenames:d.filenames,filescount:d.getFilesCount(),extra:d._getExtraData(),response:e,reader:d.reader,jqXHR:f}},_getMsgSelected:function(f){var d=this,e=f===1?d.fileSingle:d.filePlural;return f>0?d.msgSelected.replace("{n}",f).replace("{files}",e):d.msgNoFilesSelected},_getFrame:function(f){var d=this,e=c("#"+f);if(!e.length){d._log('Invalid thumb frame with id: "'+f+'".');return null}return e},_getThumbs:function(d){d=d||"";return this.getFrames(":not(.file-preview-initial)"+d)},_getExtraData:function(d,f){var e=this,g=e.uploadExtraData;if(typeof e.uploadExtraData==="function"){g=e.uploadExtraData(d,f)}return g},_initXhr:function(f,d,g){var e=this;if(f.upload){f.upload.addEventListener("progress",function(j){var k=0,i=j.total,h=j.loaded||j.position;if(j.lengthComputable){k=Math.floor(h/i*100)}if(d){e._setAsyncUploadStatus(d,k,g)}else{e._setProgress(k)}},false)}return f},_ajaxSubmit:function(h,j,k,f,d,g){var e=this,i;if(!e._raise("filepreajax",[d,g])){return}e._uploadExtra(d,g);i=c.extend(true,{},{xhr:function(){var l=c.ajaxSettings.xhr();return e._initXhr(l,d,e.getFileStack().length)},url:e.uploadUrl,type:"POST",dataType:"json",data:e.formdata,cache:false,processData:false,contentType:false,beforeSend:h,success:j,complete:k,error:f},e.ajaxSettings);e.ajaxRequests.push(c.ajax(i))},_mergeArray:function(h,g){var e=this,f=a.cleanArray(e[h]),d=a.cleanArray(g);e[h]=f.concat(d)},_initUploadSuccess:function(g,q,d){var n=this,e,j,k,m,p,l,f,o,h;if(!n.showPreview||typeof g!=="object"||c.isEmptyObject(g)){return}if(g.initialPreview!==undefined&&g.initialPreview.length>0){n.hasInitData=true;l=g.initialPreview||[];f=g.initialPreviewConfig||[];o=g.initialPreviewThumbTags||[];e=g.append===undefined||g.append?true:false;if(l.length>0&&!a.isArray(l)){l=l.split(n.initialPreviewDelimiter)}n._mergeArray("initialPreview",l);n._mergeArray("initialPreviewConfig",f);n._mergeArray("initialPreviewThumbTags",o);if(q!==undefined){if(!d){k=n.previewCache.add(l,f[0],o[0],e);j=n.previewCache.get(k,false);m=c(document.createElement("div")).html(j).hide().insertAfter(q);p=m.find(".kv-zoom-cache");if(p&&p.length){p.insertAfter(q)}q.fadeOut("slow",function(){var i=m.find(".file-preview-frame");if(i&&i.length){i.insertBefore(q).fadeIn("slow").css("display:inline-block")}n._initPreviewActions();n._clearFileInput();a.cleanZoomCache(n.$preview.find("#zoom-"+q.attr("id")));q.remove();m.remove();n._initSortable()})}else{h=q.attr("data-fileindex");n.uploadCache.content[h]=l[0];n.uploadCache.config[h]=f[0]||[];n.uploadCache.tags[h]=o[0]||[];n.uploadCache.append=e}}else{n.previewCache.set(l,f,o,e);n._initPreview();n._initPreviewActions()}}},_initSuccessThumbs:function(){var d=this;if(!d.showPreview){return}d._getThumbs(a.FRAMES+".file-preview-success").each(function(){var g=c(this),f=d.$preview,e=g.find(".kv-file-remove");e.removeAttr("disabled");d._handler(e,"click",function(){var i=g.attr("id"),h=d._raise("filesuccessremove",[i,g.attr("data-fileindex")]);a.cleanMemory(g);if(h===false){return}g.fadeOut("slow",function(){a.cleanZoomCache(f.find("#zoom-"+i));g.remove();if(!d.getFrames().length){d.reset()}})})})},_checkAsyncComplete:function(){var e=this,d,f;for(f=0;f<e.filestack.length;f++){if(e.filestack[f]){d=e.previewInitId+"-"+f;if(c.inArray(d,e.uploadLog)===-1){return false}}}return(e.uploadAsyncCount===e.uploadLog.length)},_uploadExtra:function(d,f){var e=this,g=e._getExtraData(d,f);if(g.length===0){return}c.each(g,function(h,i){e.formdata.append(h,i)})},_uploadSingle:function(s,h,g){var q=this,x=q.getFileStack().length,o=new FormData(),w,d=q.previewInitId+"-"+s,l,r,n,v,f=q.filestack.length>0||!c.isEmptyObject(q.uploadExtraData),p=c("#"+d).find(".file-thumb-progress"),j,m,e,u,k,t={id:d,index:s};q.formdata=o;if(q.showPreview){l=c("#"+d+":not(.file-preview-initial)");n=l.find(".kv-file-upload");v=l.find(".kv-file-remove");p.removeClass("hide")}if(x===0||!f||(n&&n.hasClass("disabled"))||q._abort(t)){return}k=function(z,y){q.updateStack(z,undefined);q.uploadLog.push(y);if(q._checkAsyncComplete()){q.fileBatchCompleted=true}};r=function(){var B=q.uploadCache,z,C,A,y=0,D=q.cacheInitialPreview;if(!q.fileBatchCompleted){return}if(D&&D.content){y=D.content.length}setTimeout(function(){if(q.showPreview){q.previewCache.set(B.content,B.config,B.tags,B.append);if(y){for(C=0;C<B.content.length;C++){A=C+y;D.content[A]=B.content[C];if(D.config.length){D.config[A]=B.config[C]}if(D.tags.length){D.tags[A]=B.tags[C]}}q.initialPreview=a.cleanArray(D.content);q.initialPreviewConfig=a.cleanArray(D.config);q.initialPreviewThumbTags=a.cleanArray(D.tags)}else{q.initialPreview=B.content;q.initialPreviewConfig=B.config;q.initialPreviewThumbTags=B.tags}q.cacheInitialPreview={};if(q.hasInitData){q._initPreview();q._initPreviewActions()}}q.unlock();q._clearFileInput();z=q.$preview.find(".file-preview-initial");if(q.uploadAsync&&z.length){a.addCss(z,a.SORT_CSS);q._initSortable()}q._raise("filebatchuploadcomplete",[q.filestack,q._getExtraData()]);q.uploadCount=0;q.uploadStatus={};q.uploadLog=[];q._setProgress(101)},100)};j=function(i){w=q._getOutData(i);q.fileBatchCompleted=false;if(q.showPreview){if(!l.hasClass("file-preview-success")){q._setThumbStatus(l,"Loading");a.addCss(l,"file-uploading")}n.attr("disabled",true);v.attr("disabled",true)}if(!g){q.lock()}q._raise("filepreupload",[w,d,s]);c.extend(true,t,w);if(q._abort(t)){i.abort();q._setProgressCancelled()}};m=function(z,A,y){var i=q.showPreview&&l.attr("id")?l.attr("id"):d;w=q._getOutData(y,z);c.extend(true,t,w);setTimeout(function(){if(a.isEmpty(z)||a.isEmpty(z.error)){if(q.showPreview){q._setThumbStatus(l,"Success");n.hide();q._initUploadSuccess(z,l,g);q._setProgress(101,p)}q._raise("fileuploaded",[w,i,s]);if(!g){q.updateStack(s,undefined)}else{k(s,i)}}else{q._showUploadError(z.error,t);q._setPreviewError(l,s);if(g){k(s,i)}}},100)};e=function(){setTimeout(function(){if(q.showPreview){n.removeAttr("disabled");v.removeAttr("disabled");l.removeClass("file-uploading")}if(!g){q.unlock(false);q._clearFileInput()}else{r()}q._initSuccessThumbs()},100)};u=function(y,B,z){var A=q.ajaxOperations.uploadThumb,i=q._parseError(A,y,z,(g?h[s].name:null));setTimeout(function(){if(g){k(s,d)}q.uploadStatus[d]=100;q._setPreviewError(l,s);c.extend(true,t,q._getOutData(y));q._setProgress(101,p,q.msgAjaxProgressError.replace("{operation}",A));q._showUploadError(i,t)},100)};o.append(q.uploadFileAttr,h[s],q.filenames[s]);o.append("file_id",s);q._ajaxSubmit(j,m,e,u,d,s)},_uploadBatch:function(){var m=this,d=m.filestack,k=d.length,h={},i,l,j,g,e=m.filestack.length>0||!c.isEmptyObject(m.uploadExtraData),f;m.formdata=new FormData();if(k===0||!e||m._abort(h)){return}f=function(){c.each(d,function(n){m.updateStack(n,undefined)});m._clearFileInput()};i=function(n){m.lock();var o=m._getOutData(n);if(m.showPreview){m._getThumbs().each(function(){var r=c(this),p=r.find(".kv-file-upload"),q=r.find(".kv-file-remove");if(!r.hasClass("file-preview-success")){m._setThumbStatus(r,"Loading");a.addCss(r,"file-uploading")}p.attr("disabled",true);q.attr("disabled",true)})}m._raise("filebatchpreupload",[o]);if(m._abort(o)){n.abort();m._setProgressCancelled()}};l=function(r,t,q){var s=m._getOutData(q,r),o=m._getThumbs(":not(.file-preview-error)"),n=0,p=a.isEmpty(r)||a.isEmpty(r.errorkeys)?[]:r.errorkeys;if(a.isEmpty(r)||a.isEmpty(r.error)){m._raise("filebatchuploadsuccess",[s]);f();if(m.showPreview){o.each(function(){var v=c(this),u=v.find(".kv-file-upload");v.find(".kv-file-upload").hide();m._setThumbStatus(v,"Success");v.removeClass("file-uploading");u.removeAttr("disabled")});m._initUploadSuccess(r)}else{m.reset()}m._setProgress(101)}else{if(m.showPreview){o.each(function(){var w=c(this),v=w.find(".kv-file-remove"),u=w.find(".kv-file-upload");w.removeClass("file-uploading");u.removeAttr("disabled");v.removeAttr("disabled");if(p.length===0){m._setPreviewError(w);return}if(c.inArray(n,p)!==-1){m._setPreviewError(w)}else{w.find(".kv-file-upload").hide();m._setThumbStatus(w,"Success");m.updateStack(n,undefined)}n++});m._initUploadSuccess(r)}m._showUploadError(r.error,s,"filebatchuploaderror")}};g=function(){m.unlock();m._initSuccessThumbs();m._clearFileInput();m._raise("filebatchuploadcomplete",[m.filestack,m._getExtraData()])};j=function(o,s,q){var p=m._getOutData(o),r=m.ajaxOperations.uploadBatch,n=m._parseError(r,o,q);m._showUploadError(n,p,"filebatchuploaderror");m.uploadFileCount=k-1;if(!m.showPreview){return}m._getThumbs().each(function(){var u=c(this),t=u.attr("data-fileindex");u.removeClass("file-uploading");if(m.filestack[t]!==undefined){m._setPreviewError(u)}});m._getThumbs().removeClass("file-uploading");m._getThumbs(" .kv-file-upload").removeAttr("disabled");m._getThumbs(" .kv-file-delete").removeAttr("disabled");m._setProgress(101,m.$progress,m.msgAjaxProgressError.replace("{operation}",r))};c.each(d,function(n,o){if(!a.isEmpty(d[n])){m.formdata.append(m.uploadFileAttr,o,m.filenames[n])}});m._ajaxSubmit(i,l,g,j)},_uploadExtraOnly:function(){var e=this,h={},f,g,i,d;e.formdata=new FormData();if(e._abort(h)){return}f=function(j){e.lock();var k=e._getOutData(j);e._raise("filebatchpreupload",[k]);e._setProgress(50);h.data=k;h.xhr=j;if(e._abort(h)){j.abort();e._setProgressCancelled()}};g=function(k,m,j){var l=e._getOutData(j,k);if(a.isEmpty(k)||a.isEmpty(k.error)){e._raise("filebatchuploadsuccess",[l]);e._clearFileInput();e._initUploadSuccess(k);e._setProgress(101)}else{e._showUploadError(k.error,l,"filebatchuploaderror")}};i=function(){e.unlock();e._clearFileInput();e._raise("filebatchuploadcomplete",[e.filestack,e._getExtraData()])};d=function(k,o,m){var l=e._getOutData(k),n=e.ajaxOperations.uploadExtra,j=e._parseError(n,k,m);h.data=l;e._showUploadError(j,l,"filebatchuploaderror");e._setProgress(101,e.$progress,e.msgAjaxProgressError.replace("{operation}",n))};e._ajaxSubmit(f,g,i,d)},_deleteFileIndex:function(e){var d=this,f=e.attr("data-fileindex");if(f.substring(0,5)==="init_"){f=parseInt(f.replace("init_",""));d.initialPreview=a.spliceArray(d.initialPreview,f);d.initialPreviewConfig=a.spliceArray(d.initialPreviewConfig,f);d.initialPreviewThumbTags=a.spliceArray(d.initialPreviewThumbTags,f);d.getFrames().each(function(){var h=c(this),g=h.attr("data-fileindex");if(g.substring(0,5)==="init_"){g=parseInt(g.replace("init_",""));if(g>f){g--;h.attr("data-fileindex","init_"+g)}}});if(d.uploadAsync){d.cacheInitialPreview=d.getPreview()}}},_initFileActions:function(){var d=this,e=d.$preview;if(!d.showPreview){return}d._initZoomButton();d.getFrames(" .kv-file-remove").each(function(){var i=c(this),j=i.closest(a.FRAMES),f,m=j.attr("id"),k=j.attr("data-fileindex"),l,h,g;d._handler(i,"click",function(){g=d._raise("filepreremove",[m,k]);if(g===false||!d._validateMinCount()){return false}f=j.hasClass("file-preview-error");a.cleanMemory(j);j.fadeOut("slow",function(){a.cleanZoomCache(e.find("#zoom-"+m));d.updateStack(k,undefined);d._clearObjects(j);j.remove();if(m&&f){d.$errorContainer.find('li[data-file-id="'+m+'"]').fadeOut("fast",function(){c(this).remove();if(!d._errorsExist()){d._resetErrors()}})}d._clearFileInput();var p=d.getFileStack(true),o=d.previewCache.count(),n=p.length,q=d.showPreview&&d.getFrames().length;if(n===0&&o===0&&!q){d.reset()}else{l=o+n;h=l>1?d._getMsgSelected(l):(p[0]?d._getFileNames()[0]:"");d._setCaption(h)}d._raise("fileremoved",[m,k])})})});d.getFrames(" .kv-file-upload").each(function(){var f=c(this);d._handler(f,"click",function(){var g=f.closest(a.FRAMES),h=g.attr("data-fileindex");if(!g.hasClass("file-preview-error")){d._uploadSingle(h,d.filestack,false)}})})},_initPreviewActions:function(){var f=this,g=f.$preview,d=f.deleteExtraData||{},e=a.FRAMES+" .kv-file-remove",h=function(){var i=f.isUploadable?f.previewCache.count():f.$element.get(0).files.length;if(g.find(e).length===0&&!i){f.reset();f.initialCaption=""}};f._initZoomButton();g.find(e).each(function(){var r=c(this),p=r.data("url")||f.deleteUrl,j=r.data("key");if(a.isEmpty(p)||j===undefined){return}var k=r.closest(a.FRAMES),i=f.previewCache.data,n,o,q=k.attr("data-fileindex"),l,m;q=parseInt(q.replace("init_",""));l=a.isEmpty(i.config)&&a.isEmpty(i.config[q])?null:i.config[q];m=a.isEmpty(l)||a.isEmpty(l.extra)?d:l.extra;if(typeof m==="function"){m=m()}o={id:r.attr("id"),key:j,extra:m};n=c.extend(true,{},{url:p,type:"POST",dataType:"json",data:c.extend(true,{},{key:j},m),beforeSend:function(s){f.ajaxAborted=false;f._raise("filepredelete",[j,s,m]);if(f.ajaxAborted){s.abort()}else{a.addCss(k,"file-uploading");a.addCss(r,"disabled")}},success:function(u,w,t){var v,s;if(a.isEmpty(u)||a.isEmpty(u.error)){q=parseInt((k.attr("data-fileindex")).replace("init_",""));f.previewCache.unset(q);v=f.previewCache.count();s=v>0?f._getMsgSelected(v):"";f._deleteFileIndex(k);f._setCaption(s);f._raise("filedeleted",[j,t,m])}else{o.jqXHR=t;o.response=u;f._showError(u.error,o,"filedeleteerror");k.removeClass("file-uploading");r.removeClass("disabled");h();return}k.removeClass("file-uploading").addClass("file-deleted");k.fadeOut("slow",function(){a.cleanZoomCache(g.find("#zoom-"+k.attr("id")));f._clearObjects(k);k.remove();h();if(!v&&f.getFileStack().length===0){f._setCaption("");f.reset()}})},error:function(t,w,u){var v=f.ajaxOperations.deleteThumb,s=f._parseError(v,t,u);o.jqXHR=t;o.response={};f._showError(s,o,"filedeleteerror");k.removeClass("file-uploading");h()}},f.ajaxDeleteSettings);f._handler(r,"click",function(){if(!f._validateMinCount()){return false}c.ajax(n)})})},_hideFileIcon:function(){if(this.overwriteInitial){this.$captionContainer.find(".kv-caption-icon").hide()}},_showFileIcon:function(){this.$captionContainer.find(".kv-caption-icon").show()},_getSize:function(d){var e=this,h=parseFloat(d),g,k=e.fileSizeGetter,j,f;if(!c.isNumeric(d)||!c.isNumeric(h)){return""}if(typeof k==="function"){f=k(h)}else{if(h===0){f="0.00 B"}else{g=Math.floor(Math.log(h)/Math.log(1024));j=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];f=(h/Math.pow(1024,g)).toFixed(2)*1+" "+j[g]}}return e._getLayoutTemplate("size").replace("{sizeText}",f)},_generatePreviewTemplate:function(i,C,z,d,e,x,o,r,y,k,s){var p=this,v=p.slug(z),l,f="",A=p.previewSettings[i]||p.defaults.previewSettings[i],n=A&&A.width?A.width:"",t=A&&A.height?A.height:"",q=y||p._renderFileFooter(v,o,(a.isEmpty(n)?"auto":n),x),m=p._getPreviewIcon(z),g="type-default",j=m&&p.preferIconicPreview,u=m&&p.preferIconicZoomPreview,B=function(H,F,D,h){var G=D?"zoom-"+e:e,E=p._getPreviewTemplate(H),w=(r||"")+" "+h;if(p.frameClass){w=p.frameClass+" "+w}if(D){w=w.replace(" "+a.SORT_CSS,"")}E=p._parseFilePreviewIcon(E,z);if(H==="text"){F=a.htmlEncode(F)}if(i==="object"&&!d){c.each(p.defaults.fileTypeSettings,function(I,J){if(I==="object"||I==="other"){return}if(J(z,d)){g="type-"+I}})}return E.setTokens({previewId:G,caption:v,frameClass:w,type:d,fileindex:k,width:n,height:t,typeCss:g,footer:q,data:F,template:s||i})};k=k||e.slice(e.lastIndexOf("-")+1);if(p.fileActionSettings.showZoom){f=B((u?"other":i),C,true,"kv-zoom-thumb")}f="\n"+p._getLayoutTemplate("zoomCache").replace("{zoomContent}",f);l=B((j?"other":i),C,false,"kv-preview-thumb");return l+f},_previewDefault:function(e,j,l){var n=this,f=n.$preview;if(!n.showPreview){return}var d=e?e.name:"",k=e?e.type:"",i,o=e.size||0,m=n.slug(d),h=l===true&&!n.isUploadable,g=a.objUrl.createObjectURL(e);n._clearDefaultPreview();i=n._generatePreviewTemplate("other",g,d,k,j,h,o);f.append("\n"+i);n._setThumbAttr(j,m,o);if(l===true&&n.isUploadable){n._setThumbStatus(c("#"+j),"Error")}},_previewFile:function(r,t,p,f,v){if(!this.showPreview){return}var n=this,h=n._parseFileType(t),u=t?t.name:"",s=n.slug(u),k=n.allowedPreviewTypes,e=n.allowedPreviewMimeTypes,m=n.$preview,o=k&&k.indexOf(h)>=0,l=t.size||0,d=t.type,w=(h==="text"||h==="html"||h==="image")?p.target.result:v,q,g=e&&e.indexOf(d)!==-1;if(h==="html"&&n.purifyHtml&&window.DOMPurify){w=window.DOMPurify.sanitize(w)}if(o||g){q=n._generatePreviewTemplate(h,w,u,d,f,false,l);n._clearDefaultPreview();m.append("\n"+q);var j=m.find("#"+f+" img");if(j.length&&n.autoOrientImage){a.validateOrientation(t,function(x){if(x){var y=m.find("#zoom-"+f+" img"),i="rotate-"+x;if(x>4){i+=(j.width()>j.height()?" is-portrait-gt4":" is-landscape-gt4")}a.addCss(j,i);a.addCss(y,i);n._raise("fileimageoriented",{"$img":j,file:t})}n._validateImage(f,s,d,l,w);a.adjustOrientedImage(j)})}else{n._validateImage(f,s,d,l,w)}}else{n._previewDefault(t,f)}n._setThumbAttr(f,s,l);n._initSortable()},_setThumbAttr:function(h,e,f){var d=this,g=c("#"+h);if(g.length){f=f&&f>0?d._getSize(f):"";g.data({caption:e,size:f})}},_setInitThumbAttr:function(){var g=this,l=g.previewCache.data,d=g.previewCache.count(true),h,f,k,e;if(d===0){return}for(var j=0;j<d;j++){h=l.config[j];e=g.previewInitId+"-init_"+j;f=a.ifSet("caption",h,a.ifSet("filename",h));k=a.ifSet("size",h);g._setThumbAttr(e,f,k)}},_slugDefault:function(d){return a.isEmpty(d)?"":String(d).replace(/[\-\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_readFiles:function(l){this.reader=new FileReader();var p=this,x=p.$element,o=p.$preview,d=p.reader,r=p.$previewContainer,w=p.$previewStatus,h=p.msgLoading,s=p.msgProgress,f=p.previewInitId,k=l.length,u=p.fileTypeSettings,t=p.filestack.length,e,g=p.allowedFileTypes,q=g?g.length:0,m=p.allowedFileExtensions,j=a.isEmpty(m)?"":m.join(", "),n=p.maxFilePreviewSize&&parseFloat(p.maxFilePreviewSize),i=o.length&&(!n||isNaN(n)),v=function(D,A,y,z){var C=c.extend(true,{},p._getOutData({},{},l),{id:y,index:z}),B={id:y,index:z,file:A,files:l};p._previewDefault(A,y,true);if(p.isUploadable){p.addToStack(undefined);setTimeout(function(){e(z+1)},100)}p._initFileActions();if(p.removeFromPreviewOnError){c("#"+y).remove()}return p.isUploadable?p._showUploadError(D,C):p._showError(D,B)};p.loadedImages=[];p.totalImagesCount=0;c.each(l,function(z,y){var A=p.fileTypeSettings.image;if(A&&A(y.type)){p.totalImagesCount++}});e=function(M){if(a.isEmpty(x.attr("multiple"))){k=1}if(M>=k){if(p.isUploadable&&p.filestack.length>0){p._raise("filebatchselected",[p.getFileStack()])}else{p._raise("filebatchselected",[l])}r.removeClass("file-thumb-loading");w.html("");return}var I=t+M,y=f+"-"+I,H,K,P=l[M],F,N=P.name?p.slug(P.name):"",G=(P.size||0)/1000,L,B,z="",E=a.objUrl.createObjectURL(P),R,O,D,C,Q=0,J="",A;if(q>0){for(L=0;L<q;L++){D=g[L];C=p.msgFileTypes[D]||D;J+=L===0?C:", "+C}}if(N===false){e(M+1);return}if(N.length===0){B=p.msgInvalidFileName.replace("{name}",a.htmlEncode(P.name));p.isError=v(B,P,y,M);return}if(!a.isEmpty(m)){z=new RegExp("\\.("+m.join("|")+")$","i")}F=G.toFixed(2);if(p.maxFileSize>0&&G>p.maxFileSize){B=p.msgSizeTooLarge.setTokens({name:N,size:F,maxSize:p.maxFileSize});p.isError=v(B,P,y,M);return}if(p.minFileSize!==null&&G<=a.getNum(p.minFileSize)){B=p.msgSizeTooSmall.setTokens({name:N,size:F,minSize:p.minFileSize});p.isError=v(B,P,y,M);return}if(!a.isEmpty(g)&&a.isArray(g)){for(L=0;L<g.length;L+=1){R=g[L];A=u[R];Q+=!A||(typeof A!=="function")?0:(A(P.type,P.name)?1:0)}if(Q===0){B=p.msgInvalidFileType.setTokens({name:N,types:J});p.isError=v(B,P,y,M);return}}if(Q===0&&!a.isEmpty(m)&&a.isArray(m)&&!a.isEmpty(z)){O=a.compare(N,z);Q+=a.isEmpty(O)?0:O.length;if(Q===0){B=p.msgInvalidFileExtension.setTokens({name:N,extensions:j});p.isError=v(B,P,y,M);return}}if(!p.showPreview){if(p.isUploadable){p.addToStack(P)}setTimeout(function(){e(M+1);p._updateFileDetails(k)},100);p._raise("fileloaded",[P,y,M,d]);return}if(!i&&G>n){p.addToStack(P);r.addClass("file-thumb-loading");p._previewDefault(P,y);p._initFileActions();p._updateFileDetails(k);e(M+1);return}if(o.length&&FileReader!==undefined){w.html(h.replace("{index}",M+1).replace("{files}",k));r.addClass("file-thumb-loading");d.onerror=function(S){p._errorHandler(S,N)};d.onload=function(S){p._previewFile(M,P,S,y,E);p._initFileActions()};d.onloadend=function(){B=s.setTokens({index:M+1,files:k,percent:50,name:N});setTimeout(function(){w.html(B);p._updateFileDetails(k);e(M+1)},100);p._raise("fileloaded",[P,y,M,d])};d.onprogress=function(U){if(U.lengthComputable){var T=(U.loaded/U.total)*100,S=Math.ceil(T);B=s.setTokens({index:M+1,files:k,percent:S,name:N});setTimeout(function(){w.html(B)},100)}};H=u.text;K=u.image;if(H(P.type,N)){d.readAsText(P,p.textEncoding)}else{if(K(P.type,N)){d.readAsDataURL(P)}else{d.readAsArrayBuffer(P)}}}else{p._previewDefault(P,y);setTimeout(function(){e(M+1);p._updateFileDetails(k)},100);p._raise("fileloaded",[P,y,M,d])}p.addToStack(P)};e(0);p._updateFileDetails(k,false)},_updateFileDetails:function(e){var k=this,l=k.$element,h=k.getFileStack(),d=(a.isIE(9)&&a.findFileName(l.val()))||(l[0].files[0]&&l[0].files[0].name)||(h.length&&h[0].name)||"",j=k.slug(d),f=k.isUploadable?h.length:e,i=k.previewCache.count()+f,g=f>1?k._getMsgSelected(i):j;if(k.isError){k.$previewContainer.removeClass("file-thumb-loading");k.$previewStatus.html("");k.$captionContainer.find(".kv-caption-icon").hide()}else{k._showFileIcon()}k._setCaption(g,k.isError);k.$container.removeClass("file-input-new file-input-ajax-new");if(arguments.length===1){k._raise("fileselect",[e,j])}if(k.previewCache.count()){k._initPreviewActions()}},_setThumbStatus:function(k,d){var e=this;if(!e.showPreview){return}var h="indicator"+d,j=h+"Title",g="file-preview-"+d.toLowerCase(),i=k.find(".file-upload-indicator"),f=e.fileActionSettings;k.removeClass("file-preview-success file-preview-error file-preview-loading");if(d==="Error"){k.find(".kv-file-upload").attr("disabled",true)}if(d==="Success"){k.find(".file-drag-handle").remove();i.css("margin-left",0)}i.html(f[h]);i.attr("title",f[j]);k.addClass(g)},_setProgressCancelled:function(){var d=this;d._setProgress(101,d.$progress,d.msgCancelled)},_setProgress:function(d,l,g){var k=this,i=Math.min(d,100),f,e=k.progressUploadThreshold,j=d<=100?k.progressTemplate:k.progressCompleteTemplate,h=i<100?k.progressTemplate:(g?k.progressErrorTemplate:j);l=l||k.$progress;if(!a.isEmpty(h)){if(e&&i>e&&d<=100){f=h.setTokens({percent:e,status:k.msgUploadThreshold})}else{f=h.setTokens({percent:i,status:(d>100?k.msgUploadEnd:i+"%")})}l.html(f);if(g){l.find('[role="progressbar"]').html(g)}}},_setFileDropZoneTitle:function(){var d=this,f=d.$container.find(".file-drop-zone"),g=d.dropZoneTitle,e;if(d.isClickable){e=a.isEmpty(d.$element.attr("multiple"))?d.fileSingle:d.filePlural;g+=d.dropZoneClickTitle.replace("{files}",e)}f.find("."+d.dropZoneTitleClass).remove();if(!d.isUploadable||!d.showPreview||f.length===0||d.getFileStack().length>0||!d.dropZoneEnabled){return}if(f.find(a.FRAMES).length===0&&a.isEmpty(d.defaultPreviewContent)){f.prepend('<div class="'+d.dropZoneTitleClass+'">'+g+"</div>")}d.$container.removeClass("file-input-new");a.addCss(d.$container,"file-input-ajax-new")},_setAsyncUploadStatus:function(d,h,g){var e=this,f=0;e._setProgress(h,c("#"+d).find(".file-thumb-progress"));e.uploadStatus[d]=h;c.each(e.uploadStatus,function(i,j){f+=j});e._setProgress(Math.floor(f/g))},_validateMinCount:function(){var e=this,d=e.isUploadable?e.getFileStack().length:e.$element.get(0).files.length;if(e.validateInitialCount&&e.minFileCount>0&&e._getFileCount(d-1)<e.minFileCount){e._noFilesError({});return false}return true},_getFileCount:function(f){var d=this,e=0;if(d.validateInitialCount&&!d.overwriteInitial){e=d.previewCache.count();f+=e}return f},_getFileId:function(f){var e=this,g=e.generateFileId,d;if(typeof g==="function"){return g(f,event)}if(!f){return null}d=f.webkitRelativePath||f.fileName||f.name||null;if(!d){return null}return(f.size+"-"+d.replace(/[^0-9a-zA-Z_-]/img,""))},_getFileName:function(d){return d&&d.name?this.slug(d.name):undefined},_getFileIds:function(d){var e=this;return e.fileids.filter(function(f){return(d?f!==undefined:f!==undefined&&f!==null)})},_getFileNames:function(d){var e=this;return e.filenames.filter(function(f){return(d?f!==undefined:f!==undefined&&f!==null)})},_setPreviewError:function(g,e,f){var d=this;if(e!==undefined){d.updateStack(e,f)}if(d.removeFromPreviewOnError){g.remove()}else{d._setThumbStatus(g,"Error")}},_checkDimensions:function(k,n,d,r,g,m,j){var p=this,f,l,q=n==="Small"?"min":"max",h=p[q+"Image"+m],e,o;if(a.isEmpty(h)||!d.length){return}e=d[0];l=(m==="Width")?e.naturalWidth||e.width:e.naturalHeight||e.height;o=n==="Small"?l>=h:l<=h;if(o){return}f=p["msgImage"+m+n].setTokens({name:g,size:h});p._showUploadError(f,j);p._setPreviewError(r,k,null)},_validateImage:function(n,f,p,e,o){var q=this,h=q.$preview,g,m,k,r=h.find("#"+n),j=r.attr("data-fileindex"),d=r.find("img"),l;f=f||"Untitled";d.one("load",function(){m=r.width();k=h.width();if(m>k){d.css("width","100%")}g={ind:j,id:n};q._checkDimensions(j,"Small",d,r,f,"Width",g);q._checkDimensions(j,"Small",d,r,f,"Height",g);if(!q.resizeImage){q._checkDimensions(j,"Large",d,r,f,"Width",g);q._checkDimensions(j,"Large",d,r,f,"Height",g)}q._raise("fileimageloaded",[n]);l=window.piexif?window.piexif.load(o):null;q.loadedImages.push({ind:j,img:d,thumb:r,pid:n,typ:p,siz:e,validated:false,imgData:o,exifObj:l});r.data("exif",l);q._validateAllImages()}).one("error",function(){q._raise("fileimageloaderror",[n])}).each(function(){if(this.complete){c(this).load()}else{if(this.error){c(this).error()}}})},_validateAllImages:function(){var g=this,j,f={val:0},e=g.loadedImages.length,h,d,k=g.resizeIfSizeMoreThan;if(e!==g.totalImagesCount){return}g._raise("fileimagesloaded");if(!g.resizeImage){return}for(j=0;j<g.loadedImages.length;j++){h=g.loadedImages[j];if(h.validated){continue}d=h.siz;if(d&&d>k*1000){g._getResizedImage(h,f,e)}g.loadedImages[j].validated=true}},_getResizedImage:function(B,s,o){var u=this,C=c(B.img)[0],x=C.naturalWidth,v=C.naturalHeight,e,p=1,z=u.maxImageWidth||x,w=u.maxImageHeight||v,g=!!(x&&v),y,h,i=u.imageCanvas,n,f=u.imageCanvasContext,k=B.typ,t=B.pid,r=B.ind,q=B.thumb,A,m,d=B.exifObj,j;A=function(F,E,D){if(u.isUploadable){u._showUploadError(F,E,D)}else{u._showError(F,E,D)}u._setPreviewError(q,r)};if(!u.filestack[r]||!g||(x<=z&&v<=w)){if(g&&u.filestack[r]){u._raise("fileimageresized",[t,r])}s.val++;if(s.val===o){u._raise("fileimagesresized")}if(!g){A(u.msgImageResizeError,{id:t,index:r},"fileimageresizeerror");return}}k=k||u.resizeDefaultImageType;y=x>z;h=v>w;if(u.resizePreference==="width"){p=y?z/x:(h?w/v:1)}else{p=h?w/v:(y?z/x:1)}u._resetCanvas();x*=p;v*=p;i.width=x;i.height=v;try{f.drawImage(C,0,0,x,v);n=i.toDataURL(k,u.resizeQuality);if(d){j=window.piexif.dump(d);n=window.piexif.insert(j,n)}e=a.dataURI2Blob(n);u.filestack[r]=e;u._raise("fileimageresized",[t,r]);s.val++;if(s.val===o){u._raise("fileimagesresized",[undefined,undefined])}if(!(e instanceof Blob)){A(u.msgImageResizeError,{id:t,index:r},"fileimageresizeerror")}}catch(l){s.val++;if(s.val===o){u._raise("fileimagesresized",[undefined,undefined])}m=u.msgImageResizeException.replace("{errors}",l.message);A(m,{id:t,index:r},"fileimageresizeexception")}},_initBrowse:function(e){var d=this;if(d.showBrowse){d.$btnFile=e.find(".btn-file");d.$btnFile.append(d.$element)}else{d.$element.hide()}},_initCaption:function(){var d=this,e=d.initialCaption||"";if(d.overwriteInitial||a.isEmpty(e)){d.$caption.html("");return false}d._setCaption(e);return true},_setCaption:function(i,h){var e=this,j,f,k,g,d=e.getFileStack();if(!e.$caption.length){return}if(h){j=c("<div>"+e.msgValidationError+"</div>").text();k=d.length;if(k){g=k===1&&d[0]?e._getFileNames()[0]:e._getMsgSelected(k)}else{g=e._getMsgSelected(e.msgNo)}f='<span class="'+e.msgValidationErrorClass+'">'+e.msgValidationErrorIcon+(a.isEmpty(i)?g:i)+"</span>"}else{if(a.isEmpty(i)){return}j=c("<div>"+i+"</div>").text();f=e._getLayoutTemplate("fileIcon")+j}e.$caption.html(f);e.$caption.attr("title",j);e.$captionContainer.find(".file-caption-ellipsis").attr("title",j)},_createContainer:function(){var d=this,f={"class":"file-input file-input-new"+(d.rtl?" kv-rtl":"")},e=c(document.createElement("div")).attr(f).html(d._renderMain());d.$element.before(e);d._initBrowse(e);if(d.theme){e.addClass("theme-"+d.theme)}return e},_refreshContainer:function(){var d=this,e=d.$container;e.before(d.$element);e.html(d._renderMain());d._initBrowse(e)},_renderMain:function(){var e=this,g=(e.isUploadable&&e.dropZoneEnabled)?" file-drop-zone":"file-drop-disabled",i=!e.showClose?"":e._getLayoutTemplate("close"),h=!e.showPreview?"":e._getLayoutTemplate("preview").setTokens({"class":e.previewClass,dropClass:g}),f=e.isDisabled?e.captionClass+" file-caption-disabled":e.captionClass,d=e.captionTemplate.setTokens({"class":f+" kv-fileinput-caption"});return e.mainTemplate.setTokens({"class":e.mainClass+(!e.showBrowse&&e.showCaption?" no-browse":""),preview:h,close:i,caption:d,upload:e._renderButton("upload"),remove:e._renderButton("remove"),cancel:e._renderButton("cancel"),browse:e._renderButton("browse")})},_renderButton:function(h){var l=this,d=l._getLayoutTemplate("btnDefault"),g=l[h+"Class"],j=l[h+"Title"],i=l[h+"Icon"],k=l[h+"Label"],f=l.isDisabled?" disabled":"",e="button";switch(h){case"remove":if(!l.showRemove){return""}break;case"cancel":if(!l.showCancel){return""}g+=" hide";break;case"upload":if(!l.showUpload){return""}if(l.isUploadable&&!l.isDisabled){d=l._getLayoutTemplate("btnLink").replace("{href}",l.uploadUrl)}else{e="submit"}break;case"browse":if(!l.showBrowse){return""}d=l._getLayoutTemplate("btnBrowse");break;default:return""}g+=h==="browse"?" btn-file":" fileinput-"+h+" fileinput-"+h+"-button";if(!a.isEmpty(k)){k=' <span class="'+l.buttonLabelClass+'">'+k+"</span>"}return d.setTokens({type:e,css:g,title:j,status:f,icon:i,label:k})},_renderThumbProgress:function(){var d=this;return'<div class="file-thumb-progress hide">'+d.progressTemplate.setTokens({percent:"0",status:d.msgUploadBegin})+"</div>"},_renderFileFooter:function(p,s,d,i){var q=this,f=q.fileActionSettings,n=f.showRemove,h=f.showDrag,k=f.showUpload,o=f.showZoom,g,m=q._getLayoutTemplate("footer"),e=i?f.indicatorError:f.indicatorNew,r=q._getLayoutTemplate("indicator"),j=i?f.indicatorErrorTitle:f.indicatorNewTitle,l=r.setTokens({indicator:e,indicatorTitle:j});s=q._getSize(s);if(q.isUploadable){g=m.setTokens({actions:q._renderFileActions(k,n,o,h,false,false,false),caption:p,size:s,width:d,progress:q._renderThumbProgress(),indicator:l})}else{g=m.setTokens({actions:q._renderFileActions(false,false,o,h,false,false,false),caption:p,size:s,width:d,progress:"",indicator:l})}g=a.replaceTags(g,q.previewThumbTags);return g},_renderFileActions:function(r,p,n,j,g,h,w,s){if(!r&&!p&&!n&&!j){return""}var q=this,d=h===false?"":' data-url="'+h+'"',t=w===false?"":' data-key="'+w+'"',f="",i="",o="",k="",l,v=q._getLayoutTemplate("actions"),u=q.fileActionSettings,e=q.otherActionButtons.setTokens({dataKey:t}),m=g?u.removeClass+" disabled":u.removeClass;if(p){f=q._getLayoutTemplate("actionDelete").setTokens({removeClass:m,removeIcon:u.removeIcon,removeTitle:u.removeTitle,dataUrl:d,dataKey:t})}if(r){i=q._getLayoutTemplate("actionUpload").setTokens({uploadClass:u.uploadClass,uploadIcon:u.uploadIcon,uploadTitle:u.uploadTitle})}if(n){o=q._getLayoutTemplate("actionZoom").setTokens({zoomClass:u.zoomClass,zoomIcon:u.zoomIcon,zoomTitle:u.zoomTitle})}if(j&&s){l="drag-handle-init "+u.dragClass;k=q._getLayoutTemplate("actionDrag").setTokens({dragClass:l,dragTitle:u.dragTitle,dragIcon:u.dragIcon})}return v.setTokens({"delete":f,upload:i,zoom:o,drag:k,other:e})},_browse:function(f){var d=this;d._raise("filebrowse");if(f&&f.isDefaultPrevented()){return}if(d.isError&&!d.isUploadable){d.clear()}d.$captionContainer.focus()},_filterDuplicate:function(g,h,f){var e=this,d=e._getFileId(g);if(d&&f&&f.indexOf(d)>-1){return}if(!f){f=[]}h.push(g);f.push(d)},_change:function(o){var t=this,v=t.$element;if(!t.isUploadable&&a.isEmpty(v.val())&&t.fileInputCleared){t.fileInputCleared=false;return}t.fileInputCleared=false;var p=[],j,q,u=arguments.length>1,l=t.isUploadable,i,m,d=u?o.originalEvent.dataTransfer.files:v.get(0).files,h=t.filestack.length,s=a.isEmpty(v.attr("multiple")),g=(s&&h>0),f=0,r=t._getFileIds(),k=function(e,x,n,w){var z=c.extend(true,{},t._getOutData({},{},d),{id:n,index:w}),y={id:n,index:w,file:x,files:d};return t.isUploadable?t._showUploadError(e,z):t._showError(e,y)};t.reader=null;t._resetUpload();t._hideFileIcon();if(t.isUploadable){t.$container.find(".file-drop-zone ."+t.dropZoneTitleClass).remove()}if(u){c.each(d,function(e,n){if(n&&!n.type&&n.size!==undefined&&n.size%4096===0){f++}else{t._filterDuplicate(n,p,r)}})}else{if(o.target&&o.target.files===undefined){d=o.target.value?[{name:o.target.value.replace(/^.+\\/,"")}]:[]}else{d=o.target.files||{}}if(l){c.each(d,function(e,n){t._filterDuplicate(n,p,r)})}else{p=d}}if(a.isEmpty(p)||p.length===0){if(!l){t.clear()}t._showFolderError(f);t._raise("fileselectnone");return}t._resetErrors();m=p.length;q=t._getFileCount(t.isUploadable?(t.getFileStack().length+m):m);if(t.maxFileCount>0&&q>t.maxFileCount){if(!t.autoReplace||m>t.maxFileCount){i=(t.autoReplace&&m>t.maxFileCount)?m:q;j=t.msgFilesTooMany.replace("{m}",t.maxFileCount).replace("{n}",i);t.isError=k(j,null,null,null);t.$captionContainer.find(".kv-caption-icon").hide();t._setCaption("",true);t.$container.removeClass("file-input-new file-input-ajax-new");return}if(q>t.maxFileCount){t._resetPreviewThumbs(l)}}else{if(!l||g){t._resetPreviewThumbs(false);if(g){t.clearStack()}}else{if(l&&h===0&&(!t.previewCache.count()||t.overwriteInitial)){t._resetPreviewThumbs(true)}}}if(t.isPreviewable){t._readFiles(p)}else{t._updateFileDetails(1)}t._showFolderError(f)},_abort:function(f){var d=this,e;if(d.ajaxAborted&&typeof d.ajaxAborted==="object"&&d.ajaxAborted.message!==undefined){e=c.extend(true,{},d._getOutData(),f);e.abortData=d.ajaxAborted.data||{};e.abortMessage=d.ajaxAborted.message;d._setProgress(101,d.$progress,d.msgCancelled);d._showUploadError(d.ajaxAborted.message,e,"filecustomerror");d.cancel();return true}return false},_resetFileStack:function(){var d=this,g=0,h=[],f=[],e=[];d._getThumbs().each(function(){var m=c(this),l=m.attr("data-fileindex"),k=d.filestack[l],i=m.attr("id"),j;if(l==="-1"||l===-1){return}if(k!==undefined){h[g]=k;f[g]=d._getFileName(k);e[g]=d._getFileId(k);m.attr({id:d.previewInitId+"-"+g,"data-fileindex":g});g++}else{j="uploaded-"+a.uniqId();m.attr({id:j,"data-fileindex":"-1"});d.$preview.find("#zoom-"+i).attr("id","zoom-"+j)}});d.filestack=h;d.filenames=f;d.fileids=e},_isFileSelectionValid:function(e){var d=this;e=e||0;if(d.required&&!d.getFilesCount()){d.$errorContainer.html("");d._showUploadError(d.msgFileRequired);return false}if(d.minFileCount>0&&d._getFileCount(e)<d.minFileCount){d._noFilesError({});return false}return true},clearStack:function(){var d=this;d.filestack=[];d.filenames=[];d.fileids=[];return d.$element},updateStack:function(f,e){var d=this;d.filestack[f]=e;d.filenames[f]=d._getFileName(e);d.fileids[f]=e&&d._getFileId(e)||null;return d.$element},addToStack:function(e){var d=this;d.filestack.push(e);d.filenames.push(d._getFileName(e));d.fileids.push(d._getFileId(e));return d.$element},getFileStack:function(d){var e=this;return e.filestack.filter(function(f){return(d?f!==undefined:f!==undefined&&f!==null)})},getFilesCount:function(){var e=this,d=e.isUploadable?e.getFileStack().length:e.$element.get(0).files.length;return e._getFileCount(d)},lock:function(){var d=this;d._resetErrors();d.disable();if(d.showRemove){a.addCss(d.$container.find(".fileinput-remove"),"hide")}if(d.showCancel){d.$container.find(".fileinput-cancel").removeClass("hide")}d._raise("filelock",[d.filestack,d._getExtraData()]);return d.$element},unlock:function(e){var d=this;if(e===undefined){e=true}d.enable();if(d.showCancel){a.addCss(d.$container.find(".fileinput-cancel"),"hide")}if(d.showRemove){d.$container.find(".fileinput-remove").removeClass("hide")}if(e){d._resetFileStack()}d._raise("fileunlock",[d.filestack,d._getExtraData()]);return d.$element},cancel:function(){var e=this,g=e.ajaxRequests,d=g.length,f;if(d>0){for(f=0;f<d;f+=1){e.cancelling=true;g[f].abort()}}e._setProgressCancelled();e._getThumbs().each(function(){var i=c(this),h=i.attr("data-fileindex");i.removeClass("file-uploading");if(e.filestack[h]!==undefined){i.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled");i.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")}e.unlock()});return e.$element},clear:function(){var d=this,e;if(!d._raise("fileclear")){return}d.$btnUpload.removeAttr("disabled");d._getThumbs().find("video,audio,img").each(function(){a.cleanMemory(c(this))});d._resetUpload();d.clearStack();d._clearFileInput();d._resetErrors(true);if(d._hasInitialPreview()){d._showFileIcon();d._resetPreview();d._initPreviewActions();d.$container.removeClass("file-input-new")}else{d._getThumbs().each(function(){d._clearObjects(c(this))});if(d.isUploadable){d.previewCache.data={}}d.$preview.html("");e=(!d.overwriteInitial&&d.initialCaption.length>0)?d.initialCaption:"";d.$caption.html(e);d.$caption.attr("title","");a.addCss(d.$container,"file-input-new");d._validateDefaultPreview()}if(d.$container.find(a.FRAMES).length===0){if(!d._initCaption()){d.$captionContainer.find(".kv-caption-icon").hide()}}d._hideFileIcon();d._raise("filecleared");d.$captionContainer.focus();d._setFileDropZoneTitle();return d.$element},reset:function(){var d=this;if(!d._raise("filereset")){return}d._resetPreview();d.$container.find(".fileinput-filename").text("");a.addCss(d.$container,"file-input-new");if(d.getFrames().length||d.isUploadable&&d.dropZoneEnabled){d.$container.removeClass("file-input-new")}d._setFileDropZoneTitle();d.clearStack();d.formdata={};return d.$element},disable:function(){var d=this;d.isDisabled=true;d._raise("filedisabled");d.$element.attr("disabled","disabled");d.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled");d.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",true);d._initDragDrop();return d.$element},enable:function(){var d=this;d.isDisabled=false;d._raise("fileenabled");d.$element.removeAttr("disabled");d.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled");d.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled");d._initDragDrop();return d.$element},upload:function(){var f=this,e=f.getFileStack().length,h,j,d,g=!c.isEmptyObject(f._getExtraData());if(!f.isUploadable||f.isDisabled||!f._isFileSelectionValid(e)){return}f._resetUpload();if(e===0&&!g){f._showUploadError(f.msgUploadEmpty);return}f.$progress.removeClass("hide");f.uploadCount=0;f.uploadStatus={};f.uploadLog=[];f.lock();f._setProgress(2);if(e===0&&g){f._uploadExtraOnly();return}d=f.filestack.length;f.hasInitData=false;if(f.uploadAsync){j=f._getOutData();f._raise("filebatchpreupload",[j]);f.fileBatchCompleted=false;f.uploadCache={content:[],config:[],tags:[],append:true};f.uploadAsyncCount=f.getFileStack().length;for(h=0;h<d;h++){f.uploadCache.content[h]=null;f.uploadCache.config[h]=null;f.uploadCache.tags[h]=null}f.$preview.find(".file-preview-initial").removeClass(a.SORT_CSS);f._initSortable();f.cacheInitialPreview=f.getPreview();for(h=0;h<d;h++){if(f.filestack[h]!==undefined){f._uploadSingle(h,f.filestack,true)}}return}f._uploadBatch();return f.$element},destroy:function(){var e=this,d=e.$form,h=e.$container,f=e.$element,g=e.namespace;c(document).off(g);c(window).off(g);if(d&&d.length){d.off(g)}if(e.isUploadable){e._clearFileInput()}e._cleanup();e._initPreviewCache();f.insertBefore(h).off(g).removeData();h.off().remove();return f},refresh:function(e){var d=this,f=d.$element;e=e?c.extend(true,{},d.options,e):d.options;d.destroy();f.fileinput(e);d=f.data("fileinput");if(d.isUploadable){d._clearFileInput()}if(f.val()){f.trigger("change.fileinput")}return f},zoom:function(g){var d=this,f=d._getFrame(g),e=d.$modal;if(!f){return}a.initModal(e);e.html(d._getModalContent());d._setZoomContent(f);e.modal("show");d._initZoomButtons()},getExif:function(f){var d=this,e=d._getFrame(f);return e&&e.data("exif")||null},getFrames:function(e){var d=this;e=e||"";return d.$preview.find(a.FRAMES+e)},getPreview:function(){var d=this;return{content:d.initialPreview,config:d.initialPreviewConfig,tags:d.initialPreviewThumbTags}}};c.fn.fileinput=function(f){if(!a.hasFileAPISupport()&&!a.isIE(9)){return}var e=Array.apply(null,arguments),d=[];e.shift();this.each(function(){var h=c(this),m=h.data("fileinput"),i=typeof f==="object"&&f,n=i.theme||h.data("theme"),g={},k={},o=i.language||h.data("language")||c.fn.fileinput.defaults.language||"en",j;if(!m){if(n){k=c.fn.fileinputThemes[n]||{}}if(o!=="en"&&!a.isEmpty(c.fn.fileinputLocales[o])){g=c.fn.fileinputLocales[o]||{}}j=c.extend(true,{},c.fn.fileinput.defaults,k,c.fn.fileinputLocales.en,g,i,h.data());m=new b(this,j);h.data("fileinput",m)}if(typeof f==="string"){d.push(m[f].apply(m,e))}});switch(d.length){case 0:return this;case 1:return d[0];default:return d}};c.fn.fileinput.defaults={language:"en",showCaption:true,showBrowse:true,showPreview:true,showRemove:true,showUpload:true,showCancel:true,showClose:true,showUploadedThumbs:true,browseOnZoneClick:false,autoReplace:false,autoOrientImage:true,required:false,rtl:false,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:true,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:false,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:true,removeFromPreviewOnError:false,deleteUrl:"",deleteExtraData:{},overwriteInitial:true,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-default btn-header-toggle",fullscreen:"btn btn-default",borderless:"btn btn-default",close:"btn btn-default"},preferIconicPreview:false,preferIconicZoomPreview:false,allowedPreviewTypes:undefined,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default",uploadUrl:null,uploadAsync:true,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:false,resizePreference:"width",resizeQuality:0.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:false,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-success progress-bar-striped active",progressClass:"progress-bar progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar progress-bar-success",progressErrorClass:"progress-bar progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:'<span class="close kv-error-close">&times;</span>',slugCallback:null,dropZoneEnabled:true,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:true};c.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}};c.fn.fileinput.Constructor=b;c(document).ready(function(){var d=c("input.file[type=file]");if(d.length){d.fileinput()}})}));