/*! Buttons for DataTables 1.2.1
 * Â©2016 SpryMedia Ltd - datatables.net/license
 */
(function(b){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(a){return b(a,window,document)})}else{if(typeof exports==="object"){module.exports=function(a,d){if(!a){a=window}if(!d||!d.fn.dataTable){d=require("datatables.net")(a,d).$}return b(d,a,a.document)}}else{b(jQuery,window,document)}}}(function(t,q,o,w){var u=t.fn.dataTable;var s=0;var p=0;var n=u.ext.buttons;var x=function(b,a){if(a===true){a={}}if(t.isArray(a)){a={buttons:a}}this.c=t.extend(true,{},x.defaults,a);if(a.buttons){this.c.buttons=a.buttons}this.s={dt:new u.Api(b),buttons:[],listenKeys:"",namespace:"dtb"+(s++)};this.dom={container:t("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)};this._constructor()};t.extend(x.prototype,{action:function(c,b){var a=this._nodeToButton(c);if(b===w){return a.conf.action}a.conf.action=b;return this},active:function(b,e){var d=this._nodeToButton(b);var a=this.c.dom.button.active;var c=t(d.node);if(e===w){return c.hasClass(a)}c.toggleClass(a,e===w?true:e);return this},add:function(f,a){var c=this.s.buttons;if(typeof a==="string"){var d=a.split("-");var b=this.s;for(var e=0,g=d.length-1;e<g;e++){b=b.buttons[d[e]*1]}c=b.buttons;a=d[d.length-1]*1}this._expandButton(c,f,false,a);this._draw();return this},container:function(){return this.dom.container},disable:function(b){var a=this._nodeToButton(b);t(a.node).addClass(this.c.dom.button.disabled);return this},destroy:function(){t("body").off("keyup."+this.s.namespace);var b=this.s.buttons.slice();var d,a;for(d=0,a=b.length;d<a;d++){this.remove(b[d].node)}this.dom.container.remove();var c=this.s.dt.settings()[0];for(d=0,a=c.length;d<a;d++){if(c.inst===this){c.splice(d,1);break}}return this},enable:function(b,a){if(a===false){return this.disable(b)}var c=this._nodeToButton(b);t(c.node).removeClass(this.c.dom.button.disabled);return this},name:function(){return this.c.name},node:function(b){var a=this._nodeToButton(b);return t(a.node)},remove:function(b){var e=this._nodeToButton(b);var c=this._nodeToHost(b);var d=this.s.dt;if(e.buttons.length){for(var f=e.buttons.length-1;f>=0;f--){this.remove(e.buttons[f].node)}}if(e.conf.destroy){e.conf.destroy.call(d.button(b),d,t(b),e.conf)}this._removeKey(e.conf);t(e.node).remove();var a=t.inArray(e,c);c.splice(a,1);return this},text:function(d,h){var g=this._nodeToButton(d);var c=this.c.dom.collection.buttonLiner;var a=g.inCollection&&c&&c.tag?c.tag:this.c.dom.buttonLiner.tag;var e=this.s.dt;var f=t(g.node);var b=function(i){return typeof i==="function"?i(e,f,g.conf):i};if(h===w){return b(g.conf.text)}g.conf.text=h;if(a){f.children(a).html(b(h))}else{f.html(b(h))}return this},_constructor:function(){var c=this;var d=this.s.dt;var b=d.settings()[0];var e=this.c.buttons;if(!b._buttons){b._buttons=[]}b._buttons.push({inst:this,name:this.c.name});for(var f=0,a=e.length;f<a;f++){this.add(e[f])}d.on("destroy",function(){c.destroy()});t("body").on("keyup."+this.s.namespace,function(g){if(!o.activeElement||o.activeElement===o.body){var h=String.fromCharCode(g.keyCode).toLowerCase();if(c.s.listenKeys.toLowerCase().indexOf(h)!==-1){c._keypress(h,g)}}})},_addKey:function(a){if(a.key){this.s.listenKeys+=t.isPlainObject(a.key)?a.key.key:a.key}},_draw:function(d,b){if(!d){d=this.dom.container;b=this.s.buttons}d.children().detach();for(var c=0,a=b.length;c<a;c++){d.append(b[c].inserter);if(b[c].buttons&&b[c].buttons.length){this._draw(b[c].collection,b[c].buttons)}}},_expandButton:function(l,k,j,d){var e=this.s.dt;var b=0;var h=!t.isArray(k)?[k]:k;for(var a=0,g=h.length;a<g;a++){var i=this._resolveExtends(h[a]);if(!i){continue}if(t.isArray(i)){this._expandButton(l,i,j,d);continue}var f=this._buildButton(i,j);if(!f){continue}if(d!==w){l.splice(d,0,f);d++}else{l.push(f)}if(f.conf.buttons){var c=this.c.dom.collection;f.collection=t("<"+c.tag+"/>").addClass(c.className);f.conf._collection=f.collection;this._expandButton(f.buttons,f.conf.buttons,true,d)}if(i.init){i.init.call(e.button(f.node),e,t(f.node),i)}b++}},_buildButton:function(b,j){var e=this.c.dom.button;var c=this.c.dom.buttonLiner;var a=this.c.dom.collection;var d=this.s.dt;var h=function(z){return typeof z==="function"?z(d,k,b):z};if(j&&a.button){e=a.button}if(j&&a.buttonLiner){c=a.buttonLiner}if(b.available&&!b.available(d,b)){return false}var l=function(F,C,D,E){E.action.call(C.button(D),F,C,D,E);t(C.table().node()).triggerHandler("buttons-action.dt",[C.button(D),C,D,E])};var k=t("<"+e.tag+"/>").addClass(e.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(z){z.preventDefault();if(!k.hasClass(e.disabled)&&b.action){l(z,d,k,b)}k.blur()}).on("keyup.dtb",function(z){if(z.keyCode===13){if(!k.hasClass(e.disabled)&&b.action){l(z,d,k,b)}}});if(e.tag.toLowerCase()==="a"){k.attr("href","#")}if(c.tag){var f=t("<"+c.tag+"/>").html(h(b.text)).addClass(c.className);if(c.tag.toLowerCase()==="a"){f.attr("href","#")}k.append(f)}else{k.html(h(b.text))}if(b.enabled===false){k.addClass(e.disabled)}if(b.className){k.addClass(b.className)}if(b.titleAttr){k.attr("title",b.titleAttr)}if(!b.namespace){b.namespace=".dt-button-"+(p++)}var g=this.c.dom.buttonContainer;var i;if(g&&g.tag){i=t("<"+g.tag+"/>").addClass(g.className).append(k)}else{i=k}this._addKey(b);return{conf:b,node:k.get(0),inserter:i,buttons:[],inCollection:j,collection:null}},_nodeToButton:function(b,c){if(!c){c=this.s.buttons}for(var d=0,a=c.length;d<a;d++){if(c[d].node===b){return c[d]}if(c[d].buttons.length){var e=this._nodeToButton(b,c[d].buttons);if(e){return e}}}},_nodeToHost:function(b,c){if(!c){c=this.s.buttons}for(var d=0,a=c.length;d<a;d++){if(c[d].node===b){return c}if(c[d].buttons.length){var e=this._nodeToHost(b,c[d].buttons);if(e){return e}}}},_keypress:function(d,b){var c=function(f,e){if(!f.key){return}if(f.key===d){t(e).click()}else{if(t.isPlainObject(f.key)){if(f.key.key!==d){return}if(f.key.shiftKey&&!b.shiftKey){return}if(f.key.altKey&&!b.altKey){return}if(f.key.ctrlKey&&!b.ctrlKey){return}if(f.key.metaKey&&!b.metaKey){return}t(e).click()}}};var a=function(f){for(var e=0,g=f.length;e<g;e++){c(f[e].conf,f[e].node);if(f[e].buttons.length){a(f[e].buttons)}}};a(this.s.buttons)},_removeKey:function(c){if(c.key){var b=t.isPlainObject(c.key)?c.key.key:c.key;var d=this.s.listenKeys.split("");var a=t.inArray(b,d);d.splice(a,1);this.s.listenKeys=d.join("")}},_resolveExtends:function(i){var e=this.s.dt;var a,g;var b=function(j){var k=0;while(!t.isPlainObject(j)&&!t.isArray(j)){if(j===w){return}if(typeof j==="function"){j=j(e,i);if(!j){return false}}else{if(typeof j==="string"){if(!n[j]){throw"Unknown button type: "+j}j=n[j]}}k++;if(k>30){throw"Buttons: Too many iterations"}}return t.isArray(j)?j:t.extend({},j)};i=b(i);while(i&&i.extend){if(!n[i.extend]){throw"Cannot extend unknown button type: "+i.extend}var d=b(n[i.extend]);if(t.isArray(d)){return d}else{if(!d){return false}}var h=d.className;i=t.extend({},d,i);if(h&&i.className!==h){i.className=h+" "+i.className}var c=i.postfixButtons;if(c){if(!i.buttons){i.buttons=[]}for(a=0,g=c.length;a<g;a++){i.buttons.push(c[a])}i.postfixButtons=null}var f=i.prefixButtons;if(f){if(!i.buttons){i.buttons=[]}for(a=0,g=f.length;a<g;a++){i.buttons.splice(a,0,f[a])}i.prefixButtons=null}i.extend=d.extend}return i}});x.background=function(a,c,b){if(b===w){b=400}if(a){t("<div/>").addClass(c).css("display","none").appendTo("body").fadeIn(b)}else{t("body > div."+c).fadeOut(b,function(){t(this).remove()})}};x.instanceSelector=function(b,e){if(!b){return t.map(e,function(f){return f.inst})}var a=[];var c=t.map(e,function(f){return f.name});var d=function(g){if(t.isArray(g)){for(var f=0,h=g.length;f<h;f++){d(g[f])}return}if(typeof g==="string"){if(g.indexOf(",")!==-1){d(g.split(","))}else{var i=t.inArray(t.trim(g),c);if(i!==-1){a.push(e[i].inst)}}}else{if(typeof g==="number"){a.push(e[g].inst)}}};d(b);return a};x.buttonSelector=function(h,a){var f=[];var b=function(k,j,i){var C;var B;for(var D=0,l=j.length;D<l;D++){C=j[D];if(C){B=i!==w?i+D:D+"";k.push({node:C.node,name:C.conf.name,idx:B});if(C.buttons){b(k,C.buttons,B+"-")}}}};var c=function(H,F){var G,i;var l=[];b(l,F.s.buttons);var I=t.map(l,function(y){return y.node});if(t.isArray(H)||H instanceof t){for(G=0,i=H.length;G<i;G++){c(H[G],F)}return}if(H===null||H===w||H==="*"){for(G=0,i=l.length;G<i;G++){f.push({inst:F,node:l[G].node})}}else{if(typeof H==="number"){f.push({inst:F,node:F.s.buttons[H].node})}else{if(typeof H==="string"){if(H.indexOf(",")!==-1){var k=H.split(",");for(G=0,i=k.length;G<i;G++){c(t.trim(k[G]),F)}}else{if(H.match(/^\d+(\-\d+)*$/)){var E=t.map(l,function(y){return y.idx});f.push({inst:F,node:l[t.inArray(H,E)].node})}else{if(H.indexOf(":name")!==-1){var J=H.replace(":name","");for(G=0,i=l.length;G<i;G++){if(l[G].name===J){f.push({inst:F,node:l[G].node})}}}else{t(I).filter(H).each(function(){f.push({inst:F,node:this})})}}}}else{if(typeof H==="object"&&H.nodeName){var j=t.inArray(H,I);if(j!==-1){f.push({inst:F,node:I[j]})}}}}}};for(var e=0,g=h.length;e<g;e++){var d=h[e];c(a,d)}return f};x.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}};x.version="1.2.1";t.extend(n,{collection:{text:function(a){return a.i18n("buttons.collection","Collection")},className:"buttons-collection",action:function(l,f,b,e){var h=b;var k=h.offset();var i=t(f.table().container());var g=false;if(t("div.dt-button-background").length){g=t("div.dt-button-collection").offset();t("body").trigger("click.dtb-collection")}e._collection.addClass(e.collectionLayout).css("display","none").appendTo("body").fadeIn(e.fade);var c=e._collection.css("position");if(g&&c==="absolute"){e._collection.css({top:g.top+5,left:g.left+5})}else{if(c==="absolute"){e._collection.css({top:k.top+h.outerHeight(),left:k.left});var a=k.left+e._collection.outerWidth();var d=i.offset().left+i.width();if(a>d){e._collection.css("left",k.left-(a-d))}}else{var j=e._collection.height()/2;if(j>t(q).height()/2){j=t(q).height()/2}e._collection.css("marginTop",j*-1)}}if(e.background){x.background(true,e.backgroundClassName,e.fade)}setTimeout(function(){t("div.dt-button-background").on("click.dtb-collection",function(){});t("body").on("click.dtb-collection",function(z){if(!t(z.target).parents().andSelf().filter(e._collection).length){e._collection.fadeOut(e.fade,function(){e._collection.detach()});t("div.dt-button-background").off("click.dtb-collection");x.background(false,e.backgroundClassName,e.fade);t("body").off("click.dtb-collection");f.off("buttons-action.b-internal")}})},10);if(e.autoClose){f.on("buttons-action.b-internal",function(){t("div.dt-button-background").click()})}},background:true,collectionLayout:"",backgroundClassName:"dt-button-background",autoClose:false,fade:400},copy:function(b,a){if(n.copyHtml5){return"copyHtml5"}if(n.copyFlash&&n.copyFlash.available(b,a)){return"copyFlash"}},csv:function(b,a){if(n.csvHtml5&&n.csvHtml5.available(b,a)){return"csvHtml5"}if(n.csvFlash&&n.csvFlash.available(b,a)){return"csvFlash"}},excel:function(b,a){if(n.excelHtml5&&n.excelHtml5.available(b,a)){return"excelHtml5"}if(n.excelFlash&&n.excelFlash.available(b,a)){return"excelFlash"}},pdf:function(b,a){if(n.pdfHtml5&&n.pdfHtml5.available(b,a)){return"pdfHtml5"}if(n.pdfFlash&&n.pdfFlash.available(b,a)){return"pdfFlash"}},pageLength:function(e){var a=e.settings()[0].aLengthMenu;var d=t.isArray(a[0])?a[0]:a;var b=t.isArray(a[0])?a[1]:a;var c=function(f){return f.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},f.page.len())};return{extend:"collection",text:c,className:"buttons-page-length",autoClose:true,buttons:t.map(d,function(f,g){return{text:b[g],action:function(h,i){i.page.len(f).draw()},init:function(h,i,l){var j=this;var k=function(){j.active(h.page.len()===f)};h.on("length.dt"+l.namespace,k);k()},destroy:function(h,i,j){h.off("length.dt"+j.namespace)}}}),init:function(f,g,i){var h=this;f.on("length.dt"+i.namespace,function(){h.text(c(f))})},destroy:function(f,g,h){f.off("length.dt"+h.namespace)}}}});u.Api.register("buttons()",function(b,a){if(a===w){a=b;b=w}return this.iterator(true,"table",function(c){if(c._buttons){return x.buttonSelector(x.instanceSelector(b,c._buttons),a)}},true)});u.Api.register("button()",function(b,a){var c=this.buttons(b,a);if(c.length>1){c.splice(1,c.length)}return c});u.Api.registerPlural("buttons().active()","button().active()",function(a){if(a===w){return this.map(function(b){return b.inst.active(b.node)})}return this.each(function(b){b.inst.active(b.node,a)})});u.Api.registerPlural("buttons().action()","button().action()",function(a){if(a===w){return this.map(function(b){return b.inst.action(b.node)})}return this.each(function(b){b.inst.action(b.node,a)})});u.Api.register(["buttons().enable()","button().enable()"],function(a){return this.each(function(b){b.inst.enable(b.node,a)})});u.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(a){a.inst.disable(a.node)})});u.Api.registerPlural("buttons().nodes()","button().node()",function(){var a=t();t(this.each(function(b){a=a.add(b.inst.node(b.node))}));return a});u.Api.registerPlural("buttons().text()","button().text()",function(a){if(a===w){return this.map(function(b){return b.inst.text(b.node)})}return this.each(function(b){b.inst.text(b.node,a)})});u.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(a){a.inst.node(a.node).trigger("click")})});u.Api.registerPlural("buttons().containers()","buttons().container()",function(){var a=t();t(this.each(function(b){a=a.add(b.inst.container())}));return a});u.Api.register("button().add()",function(a,b){if(this.length===1){this[0].inst.add(b,a)}return this.button(a)});u.Api.register("buttons().destroy()",function(){this.pluck("inst").unique().each(function(a){a.destroy()});return this});u.Api.registerPlural("buttons().remove()","buttons().remove()",function(){this.each(function(a){a.inst.remove(a.node)});return this});var m;u.Api.register("buttons.info()",function(b,d,c){var a=this;if(b===false){t("#datatables_buttons_info").fadeOut(function(){t(this).remove()});clearTimeout(m);m=null;return this}if(m){clearTimeout(m)}if(t("#datatables_buttons_info").length){t("#datatables_buttons_info").remove()}b=b?"<h2>"+b+"</h2>":"";t('<div id="datatables_buttons_info" class="dt-button-info"/>').html(b).append(t("<div/>")[typeof d==="string"?"html":"append"](d)).css("display","none").appendTo("body").fadeIn();if(c!==w&&c!==0){m=setTimeout(function(){a.buttons.info(false)},c)}return this});u.Api.register("buttons.exportData()",function(a){if(this.context.length){return v(new u.Api(this.context[0]),a)}});var r=t("<textarea/>")[0];var v=function(f,h){var d=t.extend(true,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:true,stripNewlines:true,decodeEntities:true,trim:true,format:{header:function(y){return g(y)},footer:function(y){return g(y)},body:function(y){return g(y)}}},h);var g=function(y){if(typeof y!=="string"){return y}if(d.stripHtml){y=y.replace(/<[^>]*>/g,"")}if(d.trim){y=y.replace(/^\s+|\s+$/g,"")}if(d.stripNewlines){y=y.replace(/\n/g," ")}if(d.decodeEntities){r.innerHTML=y;y=r.value}return y};var D=f.columns(d.columns).indexes().map(function(y){return d.format.header(f.column(y).header().innerHTML,y)}).toArray();var k=f.table().footer()?f.columns(d.columns).indexes().map(function(z){var y=f.column(z).footer();return d.format.footer(y?y.innerHTML:"",z)}).toArray():null;var l=f.rows(d.rows,d.modifier).indexes().toArray();var i=f.cells(l,d.columns).render(d.orthogonal).toArray();var b=D.length;var c=b>0?i.length/b:0;var C=new Array(c);var E=0;for(var F=0,j=c;F<j;F++){var e=new Array(b);for(var a=0;a<b;a++){e[a]=d.format.body(i[E],a,F);E++}C[F]=e}return{header:D,footer:k,body:C}};t.fn.dataTable.Buttons=x;t.fn.DataTable.Buttons=x;t(o).on("init.dt plugin-init.dt",function(b,a){if(b.namespace!=="dt"){return}var c=a.oInit.buttons||u.defaults.buttons;if(c&&!a._buttons){new x(a,c).container()}});u.ext.feature.push({fnInit:function(c){var a=new u.Api(c);var b=a.init().buttons||u.defaults.buttons;return new x(a,b).container()},cFeature:"B"});return x}));